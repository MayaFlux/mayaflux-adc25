<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang xml:lang>
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>MayaFlux Technical Documentation</title>
  <style>

code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}

ul.task-list[class]{list-style: none;}
ul.task-list li input[type="checkbox"] {
font-size: inherit;
width: 0.8em;
margin: 0 0.8em 0.2em -1.6em;
vertical-align: middle;
}
.display.math{display: block; text-align: center; margin: 0.5rem auto;}

html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
  <style type="text/css">:root {
--bg-primary: #1a1c24;
--bg-secondary: #23253a;
--bg-code: #2a2d3e;
--border-color: #2e3147;
--text-primary: #e2e4ea;
--text-secondary: #a3a7c7;
--accent-primary: #7a7ad9;
--accent-secondary: #b7c4ff;
--link-color: #8b8bdb;
}
* {
margin: 0;
padding: 0;
box-sizing: border-box;
}
body {
font-family: "Georgia", "Cambria", "Times New Roman", serif;
font-size: 16px;
line-height: 1.7;
color: var(--text-primary);
background-color: var(--bg-primary);
padding: 20px;
max-width: 900px;
margin: 0 auto;
}

nav#TOC {
background: var(--bg-secondary);
border: 1px solid var(--border-color);
border-radius: 6px;
padding: 1.5em;
margin: 2em 0;
}
nav#TOC>ul {
list-style: none;
margin-left: 0;
}
nav#TOC ul ul {
list-style: none;
margin-left: 1.5em;
margin-top: 0.5em;
}
nav#TOC li {
margin-bottom: 0.6em;
}
nav#TOC>ul>li {
font-weight: 600;
margin-bottom: 1em;
}
nav#TOC>ul>li>ul>li {
font-weight: 400;
margin-bottom: 0.4em;
}
nav#TOC a {
color: var(--link-color);
}
nav#TOC a:hover {
color: var(--accent-secondary);
}

h1,
h2,
h3,
h4,
h5,
h6 {
font-family: "Fira Code", "JetBrains Mono", "Consolas", monospace;
font-weight: 600;
color: var(--accent-secondary);
margin-top: 2em;
margin-bottom: 0.8em;
line-height: 1.3;
}
h1 {
font-size: 2.5em;
margin-top: 0;
padding-bottom: 0.3em;
border-bottom: 3px solid var(--border-color);
color: var(--accent-primary);
}
h2 {
font-size: 1.8em;
padding-bottom: 0.2em;
border-bottom: 2px solid var(--border-color);
margin-top: 2.5em;
}
h3 {
font-size: 1.4em;
color: var(--text-primary);
}
h4 {
font-size: 1.2em;
color: var(--text-secondary);
}

p {
margin-bottom: 1.2em;
color: var(--text-primary);
}
strong {
color: var(--accent-secondary);
font-weight: 600;
}
em {
color: var(--text-secondary);
font-style: italic;
}

a {
color: var(--link-color);
text-decoration: none;
border-bottom: 1px solid transparent;
transition: border-color 0.2s;
}
a:hover {
border-bottom-color: var(--link-color);
}

code {
font-family: "Fira Code", "JetBrains Mono", "Consolas", monospace;
font-size: 0.9em;
background: var(--bg-code);
padding: 0.2em 0.4em;
border-radius: 3px;
color: #e8c4b8;
}
pre {
background: var(--bg-secondary);
border: 1px solid var(--border-color);
border-radius: 6px;
padding: 1.2em;
overflow-x: auto;
margin: 1.5em 0;
box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
}
pre code {
background: transparent;
padding: 0;
font-size: 0.85em;
line-height: 1.5;
color: var(--text-primary);
}

ul,
ol {
margin-left: 1.8em;
margin-bottom: 1.2em;
}
li {
margin-bottom: 0.5em;
color: var(--text-primary);
}
ul ul,
ol ol,
ul ol,
ol ul {
margin-top: 0.5em;
margin-bottom: 0.5em;
}

blockquote {
border-left: 4px solid var(--accent-primary);
padding-left: 1.2em;
margin: 1.5em 0;
color: var(--text-secondary);
font-style: italic;
background: var(--bg-secondary);
padding: 1em 1em 1em 1.5em;
border-radius: 0 4px 4px 0;
}

table {
width: 100%;
border-collapse: collapse;
margin: 1.5em 0;
background: var(--bg-secondary);
border-radius: 6px;
overflow: hidden;
}
th,
td {
padding: 0.8em 1em;
text-align: left;
border-bottom: 1px solid var(--border-color);
}
th {
background: var(--bg-code);
color: var(--accent-secondary);
font-family: "Fira Code", monospace;
font-weight: 600;
}
tr:last-child td {
border-bottom: none;
}
tr:hover {
background: rgba(122, 122, 217, 0.05);
}

hr {
border: none;
border-top: 2px solid var(--border-color);
margin: 2.5em 0;
}

.header-info {
background: var(--bg-secondary);
border-left: 4px solid var(--accent-primary);
padding: 1.2em;
margin: 2em 0;
border-radius: 0 6px 6px 0;
}
.header-info p {
margin-bottom: 0.5em;
}
.header-info p:last-child {
margin-bottom: 0;
}

nav#TOC {
background: var(--bg-secondary);
border: 1px solid var(--border-color);
border-radius: 6px;
padding: 1.5em;
margin: 2em 0;
}
nav#TOC ul {
list-style: none;
margin-left: 0;
}
nav#TOC li {
margin-bottom: 0.4em;
}
nav#TOC>ul>li {
margin-bottom: 0.8em;
font-weight: 600;
}
nav#TOC a {
color: var(--link-color);
}

.emphasis-box {
background: rgba(122, 122, 217, 0.1);
border-left: 4px solid var(--accent-primary);
padding: 1.2em;
margin: 1.5em 0;
border-radius: 0 6px 6px 0;
}

@media print {
body {
background: white;
color: black;
max-width: 100%;
}
h1,
h2,
h3,
h4,
h5,
h6 {
color: black;
page-break-after: avoid;
}
pre,
blockquote,
table {
page-break-inside: avoid;
}
a {
color: black;
text-decoration: underline;
}
}

@media (max-width: 768px) {
body {
padding: 15px;
font-size: 15px;
}
h1 {
font-size: 2em;
}
h2 {
font-size: 1.5em;
}
pre {
padding: 1em;
font-size: 0.8em;
}
}

.sourceCode .kw {
color: #e78c8c;
font-weight: bold;
}

.sourceCode .dt {
color: #8bcdcd;
}

.sourceCode .dv {
color: #d4a76a;
}

.sourceCode .bn {
color: #d4a76a;
}

.sourceCode .fl {
color: #d4a76a;
}

.sourceCode .ch {
color: #b8bb87;
}

.sourceCode .st {
color: #b8bb87;
}

.sourceCode .co {
color: #7c7f93;
font-style: italic;
}

.sourceCode .ot {
color: #a3a7c7;
}

.sourceCode .fu {
color: #8b8bdb;
}

.sourceCode .er {
color: #e78c8c;
font-weight: bold;
}

.sourceCode .wa {
color: #e78c8c;
font-style: italic;
}

.sourceCode .cn {
color: #d4a76a;
}

.sourceCode .sc {
color: #b8bb87;
}

.sourceCode .vs {
color: #b8bb87;
}

.sourceCode .ss {
color: #b8bb87;
}

.sourceCode .va {
color: #a3a7c7;
}

.sourceCode .cf {
color: #e78c8c;
font-weight: bold;
}

.sourceCode .op {
color: #a3a7c7;
}

.sourceCode .pp {
color: #8bcdcd;
}

.sourceCode .at {
color: #8b8bdb;
}

.sourceCode .do {
color: #7c7f93;
font-style: italic;
}

.sourceCode .an {
color: #7c7f93;
font-style: italic;
}

.sourceCode .cv {
color: #7c7f93;
font-style: italic;
}

.sourceCode .in {
color: #7c7f93;
font-style: italic;
}
</style>
</head>
<body>
<header id="title-block-header">
<h1 class="title">MayaFlux Technical Documentation</h1>
</header>
<nav id="TOC" role="doc-toc">
<ul>
<li><a href="#mayaflux-digital-first-multimedia-processing-architecture" id="toc-mayaflux-digital-first-multimedia-processing-architecture">MayaFlux:
Digital-First Multimedia Processing Architecture</a>
<ul>
<li><a href="#abstract" id="toc-abstract">Abstract</a></li>
<li><a href="#table-of-contents" id="toc-table-of-contents">Table of
Contents</a></li>
<li><a href="#the-digital-first-paradigm" id="toc-the-digital-first-paradigm">The Digital-First Paradigm</a>
<ul>
<li><a href="#moving-beyond-analog-metaphors" id="toc-moving-beyond-analog-metaphors">Moving Beyond Analog
Metaphors</a></li>
<li><a href="#core-philosophy-data-transformation-as-creative-medium" id="toc-core-philosophy-data-transformation-as-creative-medium">Core
Philosophy: Data Transformation as Creative Medium</a></li>
</ul></li>
<li><a href="#core-architectural-foundations" id="toc-core-architectural-foundations">Core Architectural
Foundations</a>
<ul>
<li><a href="#nodes-unit-by-unit-transformation-precision" id="toc-nodes-unit-by-unit-transformation-precision">1. Nodes:
Unit-by-Unit Transformation Precision</a></li>
<li><a href="#buffers-temporal-gathering-spaces" id="toc-buffers-temporal-gathering-spaces">2. Buffers: Temporal
Gathering Spaces</a></li>
<li><a href="#coroutines-time-as-compositional-material" id="toc-coroutines-time-as-compositional-material">3. Coroutines: Time
as Compositional Material</a></li>
<li><a href="#containers-multi-dimensional-data-architecture" id="toc-containers-multi-dimensional-data-architecture">4. Containers:
Multi-Dimensional Data Architecture</a></li>
<li><a href="#compute-matrix-declarative-and-composable-computation-engine" id="toc-compute-matrix-declarative-and-composable-computation-engine">5.
Compute Matrix: Declarative and composable computation engine</a></li>
</ul></li>
<li><a href="#lock-free-processing-architecture" id="toc-lock-free-processing-architecture">Lock-Free Processing
Architecture</a>
<ul>
<li><a href="#the-challenge" id="toc-the-challenge">The
Challenge</a></li>
<li><a href="#the-solution-atomic-state-guards" id="toc-the-solution-atomic-state-guards">The Solution: Atomic State
Guards</a></li>
</ul></li>
<li><a href="#coroutine-temporal-coordination" id="toc-coroutine-temporal-coordination">Coroutine Temporal
Coordination</a>
<ul>
<li><a href="#vruta-scheduling-infrastructure" id="toc-vruta-scheduling-infrastructure">Vruta: Scheduling
Infrastructure</a></li>
<li><a href="#kriya-creative-temporal-patterns" id="toc-kriya-creative-temporal-patterns">Kriya: Creative Temporal
Patterns</a></li>
</ul></li>
<li><a href="#clock-systems-passive-and-active-temporal-drivers" id="toc-clock-systems-passive-and-active-temporal-drivers">Clock
Systems: Passive and Active Temporal Drivers</a>
<ul>
<li><a href="#sampleclock-passive-temporal-tracking" id="toc-sampleclock-passive-temporal-tracking">SampleClock: Passive
Temporal Tracking</a></li>
<li><a href="#frameclock-active-temporal-driver" id="toc-frameclock-active-temporal-driver">FrameClock: Active Temporal
Driver</a></li>
<li><a href="#clock-coordination-philosophy" id="toc-clock-coordination-philosophy">Clock Coordination
Philosophy</a></li>
</ul></li>
<li><a href="#computationgrammar-declarative-operation-matching" id="toc-computationgrammar-declarative-operation-matching">ComputationGrammar:
Declarative Operation Matching</a>
<ul>
<li><a href="#the-problem" id="toc-the-problem">The Problem</a></li>
<li><a href="#the-solution-rule-based-computation" id="toc-the-solution-rule-based-computation">The Solution: Rule-Based
Computation</a></li>
<li><a href="#rule-definition-examples" id="toc-rule-definition-examples">Rule Definition Examples</a></li>
<li><a href="#adaptive-pipeline-construction" id="toc-adaptive-pipeline-construction">Adaptive Pipeline
Construction</a></li>
</ul></li>
<li><a href="#yantra-pipeline-mathematical-and-temporal-transformations" id="toc-yantra-pipeline-mathematical-and-temporal-transformations">Yantra
Pipeline: Mathematical and Temporal Transformations</a>
<ul>
<li><a href="#transformer-hierarchy" id="toc-transformer-hierarchy">Transformer Hierarchy</a></li>
<li><a href="#mathematical-transformations" id="toc-mathematical-transformations">Mathematical
Transformations</a></li>
<li><a href="#temporal-transformations" id="toc-temporal-transformations">Temporal Transformations</a></li>
<li><a href="#helper-functions-with-c20-ranges" id="toc-helper-functions-with-c20-ranges">Helper Functions with C++20
Ranges</a></li>
<li><a href="#declarative-composition" id="toc-declarative-composition">Declarative Composition</a></li>
</ul></li>
<li><a href="#nddata-unified-cross-modal-processing" id="toc-nddata-unified-cross-modal-processing">NDData: Unified
Cross-Modal Processing</a>
<ul>
<li><a href="#the-problem-1" id="toc-the-problem-1">The Problem</a></li>
<li><a href="#the-solution-dimensional-abstraction" id="toc-the-solution-dimensional-abstraction">The Solution: Dimensional
Abstraction</a></li>
<li><a href="#data-modality-definitions" id="toc-data-modality-definitions">Data Modality Definitions</a></li>
<li><a href="#creating-dimensional-data" id="toc-creating-dimensional-data">Creating Dimensional Data</a></li>
<li><a href="#unified-transformation-interface" id="toc-unified-transformation-interface">Unified Transformation
Interface</a></li>
<li><a href="#region-based-access" id="toc-region-based-access">Region-Based Access</a></li>
<li><a href="#container-integration" id="toc-container-integration">Container Integration</a></li>
<li><a href="#cross-modal-workflow-example" id="toc-cross-modal-workflow-example">Cross-Modal Workflow
Example</a></li>
</ul></li>
<li><a href="#window-management-as-coroutines" id="toc-window-management-as-coroutines">Window Management as
Coroutines</a>
<ul>
<li><a href="#traditional-windowing-callback-hell" id="toc-traditional-windowing-callback-hell">Traditional Windowing:
Callback Hell</a></li>
<li><a href="#mayaflux-approach-window-events-as-eventsource" id="toc-mayaflux-approach-window-events-as-eventsource">MayaFlux
Approach: Window Events as EventSource</a></li>
<li><a href="#coroutine-event-patterns" id="toc-coroutine-event-patterns">Coroutine Event Patterns</a></li>
<li><a href="#eventsource-architecture" id="toc-eventsource-architecture">EventSource Architecture</a></li>
<li><a href="#window-processing-token" id="toc-window-processing-token">Window Processing Token</a></li>
</ul></li>
<li><a href="#domain-composition-and-processing-tokens" id="toc-domain-composition-and-processing-tokens">Domain Composition and
Processing Tokens</a>
<ul>
<li><a href="#the-token-system" id="toc-the-token-system">The Token
System</a></li>
<li><a href="#domain-composition" id="toc-domain-composition">Domain
Composition</a></li>
<li><a href="#domain-decomposition" id="toc-domain-decomposition">Domain
Decomposition</a></li>
<li><a href="#cross-domain-coordination" id="toc-cross-domain-coordination">Cross-Domain Coordination</a></li>
<li><a href="#processing-handle-access" id="toc-processing-handle-access">Processing Handle Access</a></li>
</ul></li>
<li><a href="#current-implementation-status" id="toc-current-implementation-status">Current Implementation Status</a>
<ul>
<li><a href="#fully-functional-tested" id="toc-fully-functional-tested">Fully Functional &amp; Tested</a></li>
<li><a href="#in-active-development" id="toc-in-active-development">In
Active Development</a></li>
<li><a href="#planned-expansions" id="toc-planned-expansions">Planned
Expansions</a></li>
</ul></li>
<li><a href="#future-vision-and-expansion" id="toc-future-vision-and-expansion">Future Vision and Expansion</a>
<ul>
<li><a href="#the-pluggable-philosophy" id="toc-the-pluggable-philosophy">The Pluggable Philosophy</a></li>
<li><a href="#beyond-traditional-dsp" id="toc-beyond-traditional-dsp">Beyond Traditional DSP</a></li>
<li><a href="#research-questions" id="toc-research-questions">Research
Questions</a></li>
</ul></li>
<li><a href="#seeking-adversarial-testing-and-community-validation" id="toc-seeking-adversarial-testing-and-community-validation">Seeking:
Adversarial Testing and Community Validation</a></li>
<li><a href="#contact-resources" id="toc-contact-resources">Contact
&amp; Resources</a></li>
</ul></li>
</ul>
</nav>
<h1 id="mayaflux-digital-first-multimedia-processing-architecture">MayaFlux:
Digital-First Multimedia Processing Architecture</h1>
<p><strong>ADC25 Virtual Poster Presentation - Technical Deep
Dive</strong></p>
<p>Independent Developer | Early-Stage Architectural Research</p>
<hr />
<h2 id="abstract">Abstract</h2>
<p>MayaFlux demonstrates C++20-enabled unified multimedia processing
through complete architectural composability. The framework implements
lock-free atomic synchronization, coroutine-based temporal coordination,
grammar-driven computation, and N-dimensional data abstractions that
treat audio, video/graphics, and arbitrary data streams as unified
numerical transformations rather than separate domains constrained by
analog metaphors.</p>
<p>This document presents the architectural foundations, implementation
strategies, and paradigm shifts that enable truly digital-first creative
computation.</p>
<hr />
<h2 id="table-of-contents">Table of Contents</h2>
<ol type="1">
<li><a href="#the-digital-first-paradigm">The Digital-First
Paradigm</a></li>
<li><a href="#core-architectural-foundations">Core Architectural
Foundations</a></li>
<li><a href="#lock-free-processing-architecture">Lock-Free Processing
Architecture</a></li>
<li><a href="#coroutine-temporal-coordination">Coroutine Temporal
Coordination</a></li>
<li><a href="#clock-systems-passive-and-active-temporal-drivers">Clock
Systems: Passive and Active Temporal Drivers</a></li>
<li><a href="#computationgrammar-declarative-operation-matching">ComputationGrammar:
Declarative Operation Matching</a></li>
<li><a href="#yantra-pipeline-mathematical-and-temporal-transformations">Yantra
Pipeline: Mathematical and Temporal Transformations</a></li>
<li><a href="#nddata-unified-cross-modal-processing">NDData: Unified
Cross-Modal Processing</a></li>
<li><a href="#window-management-as-coroutines">Window Management as
Coroutines</a></li>
<li><a href="#domain-composition-and-processing-tokens">Domain
Composition and Processing Tokens</a></li>
<li><a href="#current-implementation-status">Current Implementation
Status</a></li>
<li><a href="#future-vision-and-expansion">Future Vision and
Expansion</a></li>
</ol>
<hr />
<h2 id="the-digital-first-paradigm">The Digital-First Paradigm</h2>
<h3 id="moving-beyond-analog-metaphors">Moving Beyond Analog
Metaphors</h3>
<p>Traditional audio software treats digital processing as a simulation
of analog hardware. This creates artificial constraints:</p>
<ul>
<li><strong>Separate processing domains</strong>: Audio, video, and
control are isolated systems</li>
<li><strong>Callback-based timing</strong>: Legacy models inherited from
hardware interrupts</li>
<li><strong>File-based workflows</strong>: Data as static resources
rather than live material</li>
<li><strong>Hardware simulation</strong>: Virtual knobs and cables
instead of computational possibilities</li>
</ul>
<p>MayaFlux embraces <strong>true digital paradigms</strong>:</p>
<ul>
<li><strong>Unified data transformation</strong>: All streams are
numerical data that can interact</li>
<li><strong>Coroutine temporal control</strong>: Time as creative
material, not interrupt callbacks</li>
<li><strong>Grammar-defined operations</strong>: Declarative computation
based on data characteristics</li>
<li><strong>Ahead-of-time processing</strong>: Pre-calculate
transformations impossible in analog</li>
<li><strong>Recursive algorithms</strong>: Process data in ways hardware
cannot</li>
<li><strong>Cross-modal coordination</strong>: Audio parameters control
visual processing seamlessly</li>
</ul>
<h3 id="core-philosophy-data-transformation-as-creative-medium">Core
Philosophy: Data Transformation as Creative Medium</h3>
<p>Rather than separating “programming” from “composing,” MayaFlux
treats data transformation as the fundamental creative act. Mathematical
relationships become creative decisions. Temporal coordination becomes
compositional structure. Multi-dimensional data access becomes creative
material selection.</p>
<p>This isn’t just about efficiency—it’s about <strong>enabling creative
workflows that cannot exist in analog-inspired systems</strong>.</p>
<hr />
<h2 id="core-architectural-foundations">Core Architectural
Foundations</h2>
<p>MayaFlux is built on five interconnected paradigms:</p>
<h3 id="nodes-unit-by-unit-transformation-precision">1. Nodes:
Unit-by-Unit Transformation Precision</h3>
<p>Nodes provide single-sample transformation where mathematical
relationships become creative decisions. Each node operates at unit
precision with lock-free atomic registration.</p>
<p><strong>Key characteristics:</strong></p>
<ul>
<li>Sample-accurate or frame-accurate processing</li>
<li>Lock-free concurrent operation through atomic operations</li>
<li>Fluent chaining via operators (<code>&gt;&gt;</code>,
<code>*</code>, <code>+</code>)</li>
<li>Channel-based routing with bitmask management</li>
<li>Direct <code>process_sample()</code> and
<code>process_batch()</code> control</li>
</ul>
<h3 id="buffers-temporal-gathering-spaces">2. Buffers: Temporal
Gathering Spaces</h3>
<p>Buffers accumulate individual moments into collective expressions.
Unlike traditional buffers that “store” data, MayaFlux buffers are
transient collectors that gather → release → await.</p>
<p><strong>Key characteristics:</strong></p>
<ul>
<li>Processing chains with custom processor extensibility</li>
<li>Shared data coordination between buffers</li>
<li>Backend-agnostic (audio, graphics, custom)</li>
<li>Token-based processing domain assignment</li>
<li>Default processors with override capability</li>
</ul>
<h3 id="coroutines-time-as-compositional-material">3. Coroutines: Time
as Compositional Material</h3>
<p>C++20 coroutines transform time into creative material, enabling
complex temporal coordination impossible with traditional callbacks.</p>
<p><strong>Key characteristics:</strong></p>
<ul>
<li>Sample-accurate and frame-accurate temporal domains</li>
<li>Vruta (scheduling infrastructure) + Kriya (creative patterns)</li>
<li>EventChains for sequential temporal composition</li>
<li>Buffer capture mechanisms for windowed analysis</li>
<li>Cross-domain synchronization</li>
</ul>
<h3 id="containers-multi-dimensional-data-architecture">4. Containers:
Multi-Dimensional Data Architecture</h3>
<p>Containers organize data as compositional material through
region-based access with metadata organization.</p>
<p><strong>Key characteristics:</strong></p>
<ul>
<li>NDData abstractions for unified dimensional access</li>
<li>Region-based selection (temporal spans, spatial areas)</li>
<li>RegionGroups with rich metadata for creative workflow</li>
<li>Cross-modal data types (audio, spectral, visual, tensors)</li>
<li>Grammar-compatible data transformation pipelines</li>
</ul>
<h3 id="compute-matrix-declarative-and-composable-computation-engine">5.
Compute Matrix: Declarative and composable computation engine</h3>
<p>Compute Matrix allow sequencing or composing different
<code>ComputeOperations</code></p>
<p><strong>Key characteristics:</strong></p>
<ul>
<li>Opeartions are of type: <code>Analyzers</code>,
<code>Extractors</code>, <code>Sorters</code> and
<code>Transformers</code></li>
<li>Each opeartion has a Universal abstract class, and at least one
concrete class with starter algorithms</li>
<li>The design allows creating new operations on the fly or offload to
dedicated (internal or external) computational units</li>
<li>Works with NDData using concepts for compile time safety</li>
</ul>
<hr />
<h2 id="lock-free-processing-architecture">Lock-Free Processing
Architecture</h2>
<h3 id="the-challenge">The Challenge</h3>
<p>Real-time multimedia processing requires:</p>
<ul>
<li>Concurrent node/buffer/coroutine registration without blocking</li>
<li>Sample-accurate timing without lock contention</li>
<li>Dynamic graph modifications during processing</li>
<li>Zero-allocation in critical paths</li>
</ul>
<h3 id="the-solution-atomic-state-guards">The Solution: Atomic State
Guards</h3>
<p>MayaFlux implements <strong>wait-free registration</strong> and
<strong>atomic accumulation</strong> patterns:</p>
<h4 id="rootnode-lock-free-coordination">RootNode Lock-Free
Coordination</h4>
<p>Each processing domain (per channel, per token) has a
<code>RootNode</code> that acts as the central coordinator:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">// RootNode provides lock-free node registration</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> RootNode <span class="op">{</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>atomic<span class="op">&lt;</span>ProcessingState<span class="op">&gt;</span> <span class="va">m_processing_state</span><span class="op">;</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>vector<span class="op">&lt;</span><span class="bu">std::</span>shared_ptr<span class="op">&lt;</span>Node<span class="op">&gt;&gt;</span> <span class="va">m_nodes</span><span class="op">;</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    <span class="dt">bool</span> register_node<span class="op">(</span>shared_ptr<span class="op">&lt;</span>Node<span class="op">&gt;</span> node<span class="op">)</span> <span class="op">{</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Atomic state check - only register when safe</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>        ProcessingState expected <span class="op">=</span> ProcessingState<span class="op">::</span>IDLE<span class="op">;</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(!</span><span class="va">m_processing_state</span><span class="op">.</span>compare_exchange_strong<span class="op">(</span>expected<span class="op">,</span> ProcessingState<span class="op">::</span>MODIFYING<span class="op">))</span> <span class="op">{</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span>  <span class="co">// Currently processing, try later</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Safe to modify graph</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>        <span class="va">m_nodes</span><span class="op">.</span>push_back<span class="op">(</span>node<span class="op">);</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>        <span class="va">m_processing_state</span><span class="op">.</span>store<span class="op">(</span>ProcessingState<span class="op">::</span>IDLE<span class="op">);</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> process_sample<span class="op">()</span> <span class="op">{</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>        <span class="va">m_processing_state</span><span class="op">.</span>store<span class="op">(</span>ProcessingState<span class="op">::</span>ACTIVE<span class="op">);</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>        <span class="dt">double</span> sum <span class="op">=</span> <span class="fl">0.0</span><span class="op">;</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="kw">auto</span><span class="op">&amp;</span> node <span class="op">:</span> <span class="va">m_nodes</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>node<span class="op">-&gt;</span>is_registered_for_channel<span class="op">(</span>current_channel<span class="op">))</span> <span class="op">{</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>                sum <span class="op">+=</span> node<span class="op">-&gt;</span>process_sample<span class="op">();</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>        <span class="va">m_processing_state</span><span class="op">.</span>store<span class="op">(</span>ProcessingState<span class="op">::</span>IDLE<span class="op">);</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> sum<span class="op">;</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="op">};</span></span></code></pre></div>
<p><strong>Key insights:</strong></p>
<ul>
<li>No locks in audio callback path</li>
<li>Registration deferred to safe states</li>
<li>Atomic accumulation without contention</li>
<li>Channel-based processing with bitmask checks</li>
</ul>
<h4 id="nodegraphmanager-coordination">NodeGraphManager
Coordination</h4>
<p>The <code>NodeGraphManager</code> coordinates multiple RootNodes
across channels and tokens:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Each token/channel combination has its own RootNode</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="bu">std::</span>unordered_map<span class="op">&lt;</span>ProcessingToken<span class="op">,</span> <span class="bu">std::</span>vector<span class="op">&lt;</span><span class="bu">std::</span>unique_ptr<span class="op">&lt;</span>RootNode<span class="op">&gt;&gt;&gt;</span> <span class="va">m_root_nodes</span><span class="op">;</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co">// Concurrent registration across domains</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> register_node_to_channel<span class="op">(</span>shared_ptr<span class="op">&lt;</span>Node<span class="op">&gt;</span> node<span class="op">,</span> <span class="dt">uint32_t</span> channel<span class="op">)</span> <span class="op">{</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> token <span class="op">=</span> node<span class="op">-&gt;</span>get_processing_token<span class="op">();</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span><span class="op">&amp;</span> root <span class="op">=</span> <span class="va">m_root_nodes</span><span class="op">[</span>token<span class="op">][</span>channel<span class="op">];</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Atomic registration - defers if currently processing</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(!</span>root<span class="op">-&gt;</span>register_node<span class="op">(</span>node<span class="op">))</span> <span class="op">{</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>this_thread::yield<span class="op">();</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Update channel bitmask atomically</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    <span class="dt">uint32_t</span> mask <span class="op">=</span> node<span class="op">-&gt;</span><span class="va">m_channel_mask</span><span class="op">.</span>load<span class="op">();</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>    node<span class="op">-&gt;</span><span class="va">m_channel_mask</span><span class="op">.</span>store<span class="op">(</span>mask <span class="op">|</span> <span class="op">(</span><span class="dv">1</span> <span class="op">&lt;&lt;</span> channel<span class="op">));</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>This pattern extends to <strong>buffers</strong> (BufferManager) and
<strong>coroutines</strong> (TaskScheduler), providing consistent
lock-free coordination across all processing systems.</p>
<hr />
<h2 id="coroutine-temporal-coordination">Coroutine Temporal
Coordination</h2>
<h3 id="vruta-scheduling-infrastructure">Vruta: Scheduling
Infrastructure</h3>
<p>Vruta provides the foundational scheduling system for coroutine
coordination:</p>
<h4 id="taskscheduler-architecture">TaskScheduler Architecture</h4>
<div class="sourceCode" id="cb3"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> TaskScheduler <span class="op">{</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Clock systems for different temporal domains</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>unordered_map<span class="op">&lt;</span>ProcessingToken<span class="op">,</span> <span class="bu">std::</span>unique_ptr<span class="op">&lt;</span>Clock<span class="op">&gt;&gt;</span> <span class="va">m_clocks</span><span class="op">;</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Task hierarchies per domain</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>unordered_map<span class="op">&lt;</span>ProcessingToken<span class="op">,</span> <span class="bu">std::</span>vector<span class="op">&lt;</span>shared_ptr<span class="op">&lt;</span>Routine<span class="op">&gt;&gt;&gt;</span> <span class="va">m_tasks</span><span class="op">;</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> add_task<span class="op">(</span>shared_ptr<span class="op">&lt;</span>Routine<span class="op">&gt;</span> routine<span class="op">)</span> <span class="op">{</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Extract token from awaiter type</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> token <span class="op">=</span> routine<span class="op">-&gt;</span>get_processing_token<span class="op">();</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Register with appropriate clock</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>        <span class="va">m_tasks</span><span class="op">[</span>token<span class="op">].</span>push_back<span class="op">(</span>routine<span class="op">);</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>        <span class="va">m_clocks</span><span class="op">[</span>token<span class="op">]-&gt;</span>register_listener<span class="op">(</span>routine<span class="op">);</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> process_token<span class="op">(</span>ProcessingToken token<span class="op">,</span> <span class="dt">uint64_t</span> units<span class="op">)</span> <span class="op">{</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Advance clock</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>        <span class="va">m_clocks</span><span class="op">[</span>token<span class="op">]-&gt;</span>tick<span class="op">(</span>units<span class="op">);</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Process suspended coroutines</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="kw">auto</span><span class="op">&amp;</span> task <span class="op">:</span> <span class="va">m_tasks</span><span class="op">[</span>token<span class="op">])</span> <span class="op">{</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>task<span class="op">-&gt;</span>should_resume<span class="op">())</span> <span class="op">{</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>                task<span class="op">-&gt;</span>resume<span class="op">();</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a><span class="op">};</span></span></code></pre></div>
<h4 id="sample-accurate-coordination">Sample-Accurate Coordination</h4>
<div class="sourceCode" id="cb4"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Sample-accurate metro pattern</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> metro_routine <span class="op">=</span> Kriya<span class="op">::</span>metro<span class="op">(*</span>scheduler<span class="op">,</span> <span class="fl">0.25</span><span class="op">,</span> <span class="op">[]()</span> <span class="op">{</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    trigger_event<span class="op">();</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="op">});</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co">// Internally uses SampleDelay awaiter:</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> SampleDelay <span class="op">{</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    <span class="dt">uint64_t</span> samples_remaining<span class="op">;</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    <span class="dt">bool</span> await_ready<span class="op">()</span> <span class="op">{</span> <span class="cf">return</span> samples_remaining <span class="op">==</span> <span class="dv">0</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> await_suspend<span class="op">(</span>coroutine_handle<span class="op">&lt;&gt;</span> handle<span class="op">)</span> <span class="op">{</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Register with SampleClock</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>        scheduler<span class="op">-&gt;</span>register_delay<span class="op">(</span><span class="kw">this</span><span class="op">,</span> samples_remaining<span class="op">);</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="op">};</span></span></code></pre></div>
<h3 id="kriya-creative-temporal-patterns">Kriya: Creative Temporal
Patterns</h3>
<p>Kriya builds expressive temporal constructs on Vruta’s
foundation:</p>
<h4 id="eventchains-for-sequential-composition">EventChains for
Sequential Composition</h4>
<div class="sourceCode" id="cb5"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> event_chain <span class="op">=</span> MayaFlux<span class="op">::</span>create_event_chain<span class="op">()</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span>then<span class="op">([]()</span> <span class="op">{</span> start_process<span class="op">();</span> <span class="op">},</span> <span class="fl">0.0</span><span class="op">)</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span>then<span class="op">([]()</span> <span class="op">{</span> modulate_filter<span class="op">();</span> <span class="op">},</span> <span class="fl">0.125</span><span class="op">)</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span>then<span class="op">([]()</span> <span class="op">{</span> trigger_release<span class="op">();</span> <span class="op">},</span> <span class="fl">0.5</span><span class="op">);</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>event_chain<span class="op">.</span>start<span class="op">();</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co">// Internally creates coroutine with timed suspension:</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>Task<span class="op">&lt;</span><span class="dt">void</span><span class="op">&gt;</span> execute_chain<span class="op">()</span> <span class="op">{</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">co_await</span> Time<span class="op">(</span><span class="fl">0.0</span><span class="op">);</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>    start_process<span class="op">();</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">co_await</span> Time<span class="op">(</span><span class="fl">0.125</span><span class="op">);</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>    modulate_filter<span class="op">();</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">co_await</span> Time<span class="op">(</span><span class="fl">0.5</span><span class="op">);</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>    trigger_release<span class="op">();</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h4 id="buffer-capture-mechanisms">Buffer Capture Mechanisms</h4>
<div class="sourceCode" id="cb6"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> capture <span class="op">=</span> Kriya<span class="op">::</span>BufferCapture<span class="op">{</span>audio_buffer<span class="op">}</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span>for_cycle<span class="op">(</span><span class="dv">4</span><span class="op">)</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span>with_window<span class="op">(</span><span class="dv">1024</span><span class="op">,</span> <span class="fl">0.5</span><span class="bu">f</span><span class="op">)</span>  <span class="co">// Windowed analysis</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span>as_circular<span class="op">(</span><span class="dv">2048</span><span class="op">);</span>       <span class="co">// Circular buffer mode</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co">// Coroutine coordinates buffer operations temporally:</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>Task<span class="op">&lt;</span><span class="dt">void</span><span class="op">&gt;</span> capture_routine<span class="op">()</span> <span class="op">{</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> cycle <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> cycle <span class="op">&lt;</span> <span class="dv">4</span><span class="op">;</span> <span class="op">++</span>cycle<span class="op">)</span> <span class="op">{</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">co_await</span> cycle_complete<span class="op">(</span>audio_buffer<span class="op">);</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> windowed_data <span class="op">=</span> apply_window<span class="op">(</span>buffer_data<span class="op">,</span> <span class="dv">1024</span><span class="op">,</span> <span class="fl">0.5</span><span class="bu">f</span><span class="op">);</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>        process_spectral_analysis<span class="op">(</span>windowed_data<span class="op">);</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h4 id="timer-operations">Timer Operations</h4>
<div class="sourceCode" id="cb7"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">// One-shot timer</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>Timer timer<span class="op">(*</span>scheduler<span class="op">);</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>timer<span class="op">.</span>schedule<span class="op">(</span><span class="fl">2.0</span><span class="op">,</span> <span class="op">[]()</span> <span class="op">{</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>cout <span class="op">&lt;&lt;</span> <span class="st">&quot;Two seconds elapsed&quot;</span> <span class="op">&lt;&lt;</span> <span class="bu">std::</span>endl<span class="op">;</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="op">});</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co">// Node temporal control</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>NodeTimer node_timer<span class="op">(*</span>scheduler<span class="op">,</span> <span class="op">*</span>graph_manager<span class="op">);</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>node_timer<span class="op">.</span>play_for<span class="op">(</span>sine_node<span class="op">,</span> <span class="fl">2.0</span><span class="op">);</span>  <span class="co">// Play for 2 seconds</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="co">// Timed action with start/stop</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>TimedAction action<span class="op">(*</span>scheduler<span class="op">);</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>action<span class="op">.</span>execute<span class="op">(</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">[]()</span> <span class="op">{</span> <span class="bu">std::</span>cout <span class="op">&lt;&lt;</span> <span class="st">&quot;Starting&quot;</span> <span class="op">&lt;&lt;</span> <span class="bu">std::</span>endl<span class="op">;</span> <span class="op">},</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>    <span class="op">[]()</span> <span class="op">{</span> <span class="bu">std::</span>cout <span class="op">&lt;&lt;</span> <span class="st">&quot;Ending&quot;</span> <span class="op">&lt;&lt;</span> <span class="bu">std::</span>endl<span class="op">;</span> <span class="op">},</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>    <span class="fl">3.0</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a><span class="op">);</span></span></code></pre></div>
<hr />
<h2 id="clock-systems-passive-and-active-temporal-drivers">Clock
Systems: Passive and Active Temporal Drivers</h2>
<p>MayaFlux implements two fundamental clock types with different
coordination philosophies:</p>
<h3 id="sampleclock-passive-temporal-tracking">SampleClock: Passive
Temporal Tracking</h3>
<p>The <code>SampleClock</code> is <strong>passive</strong>—it doesn’t
drive processing, but is updated by the audio backend and notifies
listeners:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> SampleClock <span class="op">:</span> <span class="kw">public</span> Clock <span class="op">{</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>atomic<span class="op">&lt;</span><span class="dt">uint64_t</span><span class="op">&gt;</span> <span class="va">m_current_sample</span><span class="op">{</span><span class="dv">0</span><span class="op">};</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">uint64_t</span> <span class="va">m_sample_rate</span><span class="op">;</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span><span class="op">:</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Called by audio backend during callback</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> tick<span class="op">(</span><span class="dt">uint64_t</span> samples<span class="op">)</span> <span class="op">{</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>        <span class="va">m_current_sample</span><span class="op">.</span>fetch_add<span class="op">(</span>samples<span class="op">,</span> <span class="bu">std::</span>memory_order_release<span class="op">);</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>        notify_listeners<span class="op">(</span>samples<span class="op">);</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>    <span class="dt">uint64_t</span> current_position<span class="op">()</span> <span class="at">const</span> <span class="op">{</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">m_current_sample</span><span class="op">.</span>load<span class="op">(</span><span class="bu">std::</span>memory_order_acquire<span class="op">);</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> current_time<span class="op">()</span> <span class="at">const</span> <span class="op">{</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="kw">static_cast</span><span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;(</span><span class="va">m_current_sample</span><span class="op">)</span> <span class="op">/</span> <span class="va">m_sample_rate</span><span class="op">;</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a><span class="op">};</span></span></code></pre></div>
<p><strong>Key characteristics:</strong></p>
<ul>
<li>Updated by RtAudio backend after each callback</li>
<li>Provides sample-accurate timing for coroutines</li>
<li>Atomic position tracking for lock-free access</li>
<li>Notifies registered coroutines via TaskScheduler</li>
</ul>
<p><strong>Usage pattern:</strong></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Audio backend updates SampleClock</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> audio_callback<span class="op">(</span><span class="dt">float</span><span class="op">*</span> buffer<span class="op">,</span> <span class="dt">uint32_t</span> frames<span class="op">)</span> <span class="op">{</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Process nodes/buffers</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    process_audio_graph<span class="op">(</span>buffer<span class="op">,</span> frames<span class="op">);</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Update temporal state</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    sample_clock<span class="op">-&gt;</span>tick<span class="op">(</span>frames<span class="op">);</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Coroutines suspended on SampleDelay are notified</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h3 id="frameclock-active-temporal-driver">FrameClock: Active Temporal
Driver</h3>
<p>The <code>FrameClock</code> is <strong>active</strong>—it drives the
GPU/Vulkan processing thread at target FPS:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> FrameClock <span class="op">:</span> <span class="kw">public</span> Clock <span class="op">{</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>atomic<span class="op">&lt;</span><span class="dt">uint64_t</span><span class="op">&gt;</span> <span class="va">m_current_frame</span><span class="op">{</span><span class="dv">0</span><span class="op">};</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">uint32_t</span> <span class="va">m_target_fps</span><span class="op">;</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>chrono::steady_clock::time_point <span class="va">m_next_frame_time</span><span class="op">;</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>chrono::nanoseconds <span class="va">m_frame_duration</span><span class="op">;</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span><span class="op">:</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Drives graphics rendering loop</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> tick<span class="op">(</span><span class="dt">uint64_t</span> forced_frames <span class="op">=</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> now <span class="op">=</span> <span class="bu">std::</span>chrono::steady_clock::now<span class="op">();</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>        <span class="dt">uint64_t</span> frames_to_advance <span class="op">=</span> forced_frames <span class="op">&gt;</span> <span class="dv">0</span> <span class="op">?</span> forced_frames <span class="op">:</span> calculate_elapsed_frames<span class="op">(</span>now<span class="op">);</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>frames_to_advance <span class="op">&gt;</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>            <span class="va">m_current_frame</span><span class="op">.</span>fetch_add<span class="op">(</span>frames_to_advance<span class="op">,</span> <span class="bu">std::</span>memory_order_release<span class="op">);</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>            update_fps_measurement<span class="op">(</span>now<span class="op">);</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>            <span class="va">m_last_tick_time</span> <span class="op">=</span> now<span class="op">;</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>            <span class="va">m_next_frame_time</span> <span class="op">=</span> now <span class="op">+</span> <span class="va">m_frame_duration</span><span class="op">;</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>            notify_listeners<span class="op">(</span>frames_to_advance<span class="op">)</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>chrono::nanoseconds time_until_next_frame<span class="op">()</span> <span class="at">const</span> <span class="op">{</span></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> now <span class="op">=</span> <span class="bu">std::</span>chrono::steady_clock::now<span class="op">();</span></span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> until_next <span class="op">=</span> <span class="va">m_next_frame_time</span> <span class="op">-</span> now<span class="op">;</span></span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>until_next<span class="op">.</span>count<span class="op">()</span> <span class="op">&lt;</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="bu">std::</span>chrono::nanoseconds<span class="op">(</span><span class="dv">0</span><span class="op">);</span></span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">std::</span>chrono::duration_cast<span class="op">&lt;</span><span class="bu">std::</span>chrono::nanoseconds<span class="op">&gt;(</span>until_next<span class="op">);</span></span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a>    <span class="dt">bool</span> is_frame_late<span class="op">()</span> <span class="at">const</span> <span class="op">{</span></span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">std::</span>chrono::steady_clock::now<span class="op">()</span> <span class="op">&gt;</span> <span class="va">m_next_frame_time</span><span class="op">;</span></span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a><span class="op">};</span></span></code></pre></div>
<p><strong>Key characteristics:</strong></p>
<ul>
<li>Actively drives rendering loop at target FPS</li>
<li>Calculates frame timing and lag</li>
<li>Provides sleep hints for vsync coordination</li>
<li>Notifies visual-rate coroutines</li>
</ul>
<p><strong>Usage pattern:</strong></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Graphics thread driven by FrameClock</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> graphics_loop<span class="op">()</span> <span class="op">{</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>running<span class="op">)</span> <span class="op">{</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>        frame_clock<span class="op">-&gt;</span>tick<span class="op">();</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Process visual nodes</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>        process_visual_graph<span class="op">();</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Render frame</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>        render_to_swapchain<span class="op">();</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Sleep until next frame</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> sleep_duration <span class="op">=</span> frame_clock<span class="op">-&gt;</span>time_until_next_frame<span class="op">();</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>this_thread::sleep_for<span class="op">(</span>sleep_duration<span class="op">);</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h3 id="clock-coordination-philosophy">Clock Coordination
Philosophy</h3>
<p>This <strong>dual-clock architecture</strong> reflects a fundamental
design insight:</p>
<ul>
<li><strong>Audio processing is reactive</strong>: Driven by hardware
callback timing</li>
<li><strong>Visual processing is proactive</strong>: Self-timed to match
display refresh</li>
</ul>
<p>By implementing clocks with different ownership models, MayaFlux
enables natural coordination between these temporal domains while
maintaining their distinct characteristics.</p>
<p>Coroutines registered to SAMPLE_ACCURATE tokens listen to SampleClock
updates, while FRAME_ACCURATE coroutines listen to FrameClock. This
allows audio-visual synchronization through coordinated temporal
notification without forcing one domain to match the other’s timing
model.</p>
<hr />
<h2 id="computationgrammar-declarative-operation-matching">ComputationGrammar:
Declarative Operation Matching</h2>
<h3 id="the-problem">The Problem</h3>
<p>Traditional DSP frameworks require explicit operation selection:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Traditional approach - manual operation selection</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="op">(</span>is_audio_data<span class="op">(</span>input<span class="op">))</span> <span class="op">{</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    apply_fft<span class="op">(</span>input<span class="op">);</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="op">}</span> <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>is_spectral_data<span class="op">(</span>input<span class="op">))</span> <span class="op">{</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    apply_ifft<span class="op">(</span>input<span class="op">);</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>This becomes unwieldy for complex pipelines with multiple data
modalities, contexts, and transformation requirements.</p>
<h3 id="the-solution-rule-based-computation">The Solution: Rule-Based
Computation</h3>
<p>ComputationGrammar enables <strong>declarative operation
matching</strong> based on input characteristics:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> ComputationGrammar <span class="op">{</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> Rule <span class="op">{</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>string name<span class="op">;</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>        UniversalMatcher matcher<span class="op">;</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>        ExecutionFunction executor<span class="op">;</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>        ComputationContext context<span class="op">;</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> priority<span class="op">;</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>vector<span class="op">&lt;</span>Rule<span class="op">&gt;</span> <span class="va">m_rules</span><span class="op">;</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span><span class="op">:</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Define rule declaratively</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>    RuleBuilder create_rule<span class="op">(</span><span class="at">const</span> <span class="bu">std::</span>string<span class="op">&amp;</span> name<span class="op">)</span> <span class="op">{</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> RuleBuilder<span class="op">(*</span><span class="kw">this</span><span class="op">,</span> name<span class="op">);</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Execute matching rule</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>any execute<span class="op">(</span><span class="at">const</span> <span class="bu">std::</span>any<span class="op">&amp;</span> input<span class="op">,</span> <span class="at">const</span> ExecutionContext<span class="op">&amp;</span> ctx<span class="op">)</span> <span class="op">{</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="kw">auto</span><span class="op">&amp;</span> rule <span class="op">:</span> <span class="va">m_rules</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>rule<span class="op">.</span>matcher<span class="op">.</span>matches<span class="op">(</span>input<span class="op">,</span> ctx<span class="op">)</span> <span class="op">&amp;&amp;</span> rule<span class="op">.</span>context <span class="op">==</span> ctx<span class="op">.</span>context<span class="op">)</span> <span class="op">{</span></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> rule<span class="op">.</span>executor<span class="op">(</span>input<span class="op">,</span> ctx<span class="op">);</span></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">throw</span> <span class="bu">std::</span>runtime_error<span class="op">(</span><span class="st">&quot;No matching rule found&quot;</span><span class="op">);</span></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a><span class="op">};</span></span></code></pre></div>
<h3 id="rule-definition-examples">Rule Definition Examples</h3>
<h4 id="simple-type-based-matching">Simple Type-Based Matching</h4>
<div class="sourceCode" id="cb14"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>grammar<span class="op">.</span>create_rule<span class="op">(</span><span class="st">&quot;normalize_audio&quot;</span><span class="op">)</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span>with_context<span class="op">(</span>ComputationContext<span class="op">::</span>MATHEMATICAL<span class="op">)</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span>with_priority<span class="op">(</span><span class="dv">100</span><span class="op">)</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="dt">matches_type</span><span class="op">&lt;</span><span class="bu">std::</span>vector<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;&gt;()</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span>executes<span class="op">([](</span><span class="at">const</span> <span class="bu">std::</span>any<span class="op">&amp;</span> input<span class="op">,</span> <span class="at">const</span> ExecutionContext<span class="op">&amp;</span> ctx<span class="op">)</span> <span class="op">{</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> data <span class="op">=</span> <span class="bu">std::</span>any_cast<span class="op">&lt;</span><span class="bu">std::</span>vector<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;&gt;(</span>input<span class="op">);</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>        <span class="dt">double</span> max_val <span class="op">=</span> <span class="op">*</span><span class="bu">std::</span>max_element<span class="op">(</span>data<span class="op">.</span>begin<span class="op">(),</span> data<span class="op">.</span>end<span class="op">());</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="kw">auto</span><span class="op">&amp;</span> sample <span class="op">:</span> data<span class="op">)</span> <span class="op">{</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>            sample <span class="op">/=</span> max_val<span class="op">;</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> data<span class="op">;</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">})</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span>build<span class="op">();</span></span></code></pre></div>
<h4 id="complex-matcher-combinations">Complex Matcher Combinations</h4>
<div class="sourceCode" id="cb15"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> spectral_matcher <span class="op">=</span> UniversalMatcher<span class="op">::</span>combine_and<span class="op">({</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    UniversalMatcher<span class="op">::</span>create_type_matcher<span class="op">&lt;</span><span class="bu">std::</span>vector<span class="op">&lt;</span>DataVariant<span class="op">&gt;&gt;(),</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    UniversalMatcher<span class="op">::</span>create_context_matcher<span class="op">(</span>ComputationContext<span class="op">::</span>SPECTRAL<span class="op">),</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    UniversalMatcher<span class="op">::</span>create_parameter_matcher<span class="op">(</span><span class="st">&quot;frequency_range&quot;</span><span class="op">,</span> <span class="st">&quot;audio&quot;</span><span class="op">)</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="op">});</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>grammar<span class="op">.</span>create_rule<span class="op">(</span><span class="st">&quot;spectral_filter&quot;</span><span class="op">)</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span>matches_custom<span class="op">(</span>spectral_matcher<span class="op">)</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span>executes<span class="op">([](</span><span class="at">const</span> <span class="bu">std::</span>any<span class="op">&amp;</span> input<span class="op">,</span> <span class="at">const</span> ExecutionContext<span class="op">&amp;</span> ctx<span class="op">)</span> <span class="op">{</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Apply frequency-domain filtering</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> data <span class="op">=</span> <span class="bu">std::</span>any_cast<span class="op">&lt;</span><span class="bu">std::</span>vector<span class="op">&lt;</span>DataVariant<span class="op">&gt;&gt;(</span>input<span class="op">);</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> apply_spectral_filter<span class="op">(</span>data<span class="op">,</span> ctx<span class="op">);</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">})</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span>build<span class="op">();</span></span></code></pre></div>
<h4 id="automatic-transformer-integration">Automatic Transformer
Integration</h4>
<div class="sourceCode" id="cb16"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Integrate existing transformers as grammar rules</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>grammar<span class="op">.</span>add_operation_rule<span class="op">&lt;</span>MathematicalTransformer<span class="op">&lt;&gt;&gt;(</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;auto_normalize&quot;</span><span class="op">,</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    ComputationContext<span class="op">::</span>MATHEMATICAL<span class="op">,</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    UniversalMatcher<span class="op">::</span>create_type_matcher<span class="op">&lt;</span><span class="bu">std::</span>vector<span class="op">&lt;</span>DataVariant<span class="op">&gt;&gt;(),</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">{{</span><span class="st">&quot;operation&quot;</span><span class="op">,</span> <span class="st">&quot;normalize&quot;</span><span class="op">},</span> <span class="op">{</span><span class="st">&quot;target_peak&quot;</span><span class="op">,</span> <span class="fl">1.0</span><span class="op">}},</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>    <span class="dv">75</span>  <span class="co">// priority</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="op">);</span></span></code></pre></div>
<h3 id="adaptive-pipeline-construction">Adaptive Pipeline
Construction</h3>
<p>ComputationGrammar enables <strong>context-aware operation
chains</strong>:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> pipeline <span class="op">=</span> ComputationPipeline<span class="op">(</span>grammar<span class="op">);</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co">// Pipeline automatically selects operations based on input</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> result <span class="op">=</span> pipeline</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span>add_input<span class="op">(</span>audio_data<span class="op">)</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span>with_context<span class="op">(</span>ComputationContext<span class="op">::</span>TEMPORAL<span class="op">)</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span>with_parameter<span class="op">(</span><span class="st">&quot;window_size&quot;</span><span class="op">,</span> <span class="dv">1024</span><span class="op">)</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span>execute<span class="op">();</span></span></code></pre></div>
<p>The grammar system matches rules in priority order, enabling
hierarchical decision-making and exception handling patterns.</p>
<hr />
<h2 id="yantra-pipeline-mathematical-and-temporal-transformations">Yantra
Pipeline: Mathematical and Temporal Transformations</h2>
<p>Yantra provides the transformation infrastructure that works with
ComputationGrammar. While the specific algorithms are still being
developed, <strong>the architecture is solid and enables declarative
composition</strong>.</p>
<h3 id="transformer-hierarchy">Transformer Hierarchy</h3>
<div class="sourceCode" id="cb18"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Base transformer interface</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="kw">template</span> <span class="op">&lt;</span>ComputeData InputType<span class="op">,</span> ComputeData OutputType<span class="op">&gt;</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> UniversalTransformer <span class="op">{</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span><span class="op">:</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">virtual</span> TransformationType <span class="dt">get_transformation_type</span><span class="op">()</span> <span class="at">const</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">virtual</span> IO<span class="op">&lt;</span>OutputType<span class="op">&gt;</span> apply_operation<span class="op">(</span><span class="at">const</span> IO<span class="op">&lt;</span>InputType<span class="op">&gt;&amp;</span> input<span class="op">)</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Chainable composition</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> NextTransformer<span class="op">&gt;</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> chain<span class="op">(</span>NextTransformer<span class="op">&amp;&amp;</span> next<span class="op">)</span> <span class="op">{</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> ComposedTransformer<span class="op">(*</span><span class="kw">this</span><span class="op">,</span> <span class="bu">std::</span>forward<span class="op">&lt;</span>NextTransformer<span class="op">&gt;(</span>next<span class="op">));</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a><span class="op">};</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a><span class="co">// Concrete implementations</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a><span class="kw">enum</span> <span class="kw">class</span> TransformationType <span class="op">{</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>    MATHEMATICAL<span class="op">,</span>  <span class="co">// Normalization, scaling, polynomial</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>    TEMPORAL<span class="op">,</span>      <span class="co">// Reversal, time-stretch, delay</span></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>    SPECTRAL<span class="op">,</span>      <span class="co">// FFT, filtering, phase manipulation</span></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>    STRUCTURAL     <span class="co">// Reshaping, dimensional transforms</span></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a><span class="op">};</span></span></code></pre></div>
<h3 id="mathematical-transformations">Mathematical Transformations</h3>
<div class="sourceCode" id="cb19"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> MathematicalTransformer <span class="op">:</span> <span class="kw">public</span> UniversalTransformer<span class="op">&lt;...&gt;</span> <span class="op">{</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">enum</span> <span class="kw">class</span> MathOperation <span class="op">{</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>        NORMALIZE<span class="op">,</span> SCALE<span class="op">,</span> CLAMP<span class="op">,</span> POLYNOMIAL<span class="op">,</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>        INTERPOLATE<span class="op">,</span> SMOOTH</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>    IO<span class="op">&lt;</span>OutputType<span class="op">&gt;</span> apply_operation<span class="op">(</span><span class="at">const</span> IO<span class="op">&lt;</span>InputType<span class="op">&gt;&amp;</span> input<span class="op">)</span> <span class="kw">override</span> <span class="op">{</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">switch</span> <span class="op">(</span><span class="va">m_operation</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>            <span class="cf">case</span> MathOperation<span class="op">::</span>NORMALIZE<span class="op">:</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> normalize_data<span class="op">(</span>input<span class="op">);</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>            <span class="cf">case</span> MathOperation<span class="op">::</span>SCALE<span class="op">:</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> scale_data<span class="op">(</span>input<span class="op">,</span> <span class="va">m_params</span><span class="op">[</span><span class="st">&quot;scale_factor&quot;</span><span class="op">]);</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>            <span class="co">// ... other operations</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a><span class="op">};</span></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a><span class="co">// Usage</span></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> normalizer <span class="op">=</span> MathematicalTransformer<span class="op">(</span>MathOperation<span class="op">::</span>NORMALIZE<span class="op">);</span></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> scaled <span class="op">=</span> normalizer<span class="op">.</span>apply_operation<span class="op">(</span>audio_input<span class="op">);</span></span></code></pre></div>
<h3 id="temporal-transformations">Temporal Transformations</h3>
<div class="sourceCode" id="cb20"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> TemporalTransformer <span class="op">:</span> <span class="kw">public</span> UniversalTransformer<span class="op">&lt;...&gt;</span> <span class="op">{</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">enum</span> <span class="kw">class</span> TemporalOperation <span class="op">{</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>        TIME_REVERSE<span class="op">,</span> TIME_STRETCH<span class="op">,</span> DELAY<span class="op">,</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>        FADE_IN_OUT<span class="op">,</span> SLICE<span class="op">,</span> INTERPOLATE</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>    IO<span class="op">&lt;</span>OutputType<span class="op">&gt;</span> apply_operation<span class="op">(</span><span class="at">const</span> IO<span class="op">&lt;</span>InputType<span class="op">&gt;&amp;</span> input<span class="op">)</span> <span class="kw">override</span> <span class="op">{</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">switch</span> <span class="op">(</span><span class="va">m_operation</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>            <span class="cf">case</span> TemporalOperation<span class="op">::</span>TIME_REVERSE<span class="op">:</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> reverse_temporal_order<span class="op">(</span>input<span class="op">);</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>            <span class="cf">case</span> TemporalOperation<span class="op">::</span>TIME_STRETCH<span class="op">:</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> stretch_time<span class="op">(</span>input<span class="op">,</span> <span class="va">m_params</span><span class="op">[</span><span class="st">&quot;stretch_factor&quot;</span><span class="op">]);</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>            <span class="co">// ... other operations</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a><span class="op">};</span></span></code></pre></div>
<h3 id="helper-functions-with-c20-ranges">Helper Functions with C++20
Ranges</h3>
<p>Yantra leverages <strong>C++20 ranges</strong> for efficient data
manipulation:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Time reversal using ranges (in-place)</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="kw">template</span> <span class="op">&lt;</span>OperationReadyData DataType<span class="op">&gt;</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>DataType transform_time_reverse<span class="op">(</span>DataType<span class="op">&amp;</span> input<span class="op">)</span> <span class="op">{</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> <span class="op">[</span>target_data<span class="op">,</span> structure_info<span class="op">]</span> <span class="op">=</span> OperationHelper<span class="op">::</span>extract_structured_double<span class="op">(</span>input<span class="op">);</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="kw">auto</span><span class="op">&amp;</span> span <span class="op">:</span> target_data<span class="op">)</span> <span class="op">{</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>ranges::reverse<span class="op">(</span>span<span class="op">);</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> reconstructed <span class="op">=</span> target_data</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>        <span class="op">|</span> <span class="bu">std::</span>views::transform<span class="op">([](</span><span class="at">const</span> <span class="kw">auto</span><span class="op">&amp;</span> span<span class="op">)</span> <span class="op">{</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>              <span class="cf">return</span> <span class="bu">std::</span>vector<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;(</span>span<span class="op">.</span>begin<span class="op">(),</span> span<span class="op">.</span>end<span class="op">());</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>          <span class="op">})</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>        <span class="op">|</span> <span class="bu">std::</span>ranges::to<span class="op">&lt;</span><span class="bu">std::</span>vector<span class="op">&gt;();</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> OperationHelper<span class="op">::</span>reconstruct_from_double<span class="op">&lt;</span>DataType<span class="op">&gt;(</span>reconstructed<span class="op">,</span> structure_info<span class="op">);</span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a><span class="co">// Overlap-add processing with ranges</span></span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a><span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> TransformFunc<span class="op">&gt;</span></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a><span class="bu">std::</span>vector<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;</span> process_overlap_add<span class="op">(</span></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">const</span> <span class="bu">std::</span>span<span class="op">&lt;</span><span class="at">const</span> <span class="dt">double</span><span class="op">&gt;&amp;</span> data<span class="op">,</span></span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>    <span class="dt">uint32_t</span> window_size<span class="op">,</span></span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>    <span class="dt">uint32_t</span> hop_size<span class="op">,</span></span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>    TransformFunc transform_func<span class="op">)</span></span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">const</span> <span class="dt">size_t</span> num_windows <span class="op">=</span> <span class="op">(</span>data<span class="op">.</span>size<span class="op">()</span> <span class="op">-</span> window_size<span class="op">)</span> <span class="op">/</span> hop_size <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>vector<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;</span> output<span class="op">(</span>data<span class="op">.</span>size<span class="op">(),</span> <span class="fl">0.0</span><span class="op">);</span></span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>ranges::for_each<span class="op">(</span><span class="bu">std::</span>views::iota<span class="op">(</span><span class="dt">size_t</span><span class="op">{</span><span class="dv">0</span><span class="op">},</span> num_windows<span class="op">),</span> <span class="op">[&amp;](</span><span class="dt">size_t</span> win<span class="op">)</span> <span class="op">{</span></span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a>        <span class="dt">size_t</span> start_idx <span class="op">=</span> win <span class="op">*</span> hop_size<span class="op">;</span></span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> window_data <span class="op">=</span> data<span class="op">.</span>subspan<span class="op">(</span>start_idx<span class="op">,</span></span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a>            <span class="bu">std::</span>min<span class="op">(</span>window_size<span class="op">,</span> data<span class="op">.</span>size<span class="op">()</span> <span class="op">-</span> start_idx<span class="op">));</span></span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> transformed <span class="op">=</span> transform_func<span class="op">(</span>window_data<span class="op">);</span></span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-37"><a href="#cb21-37" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">size_t</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> transformed<span class="op">.</span>size<span class="op">();</span> <span class="op">++</span>i<span class="op">)</span> <span class="op">{</span></span>
<span id="cb21-38"><a href="#cb21-38" aria-hidden="true" tabindex="-1"></a>            output<span class="op">[</span>start_idx <span class="op">+</span> i<span class="op">]</span> <span class="op">+=</span> transformed<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb21-39"><a href="#cb21-39" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb21-40"><a href="#cb21-40" aria-hidden="true" tabindex="-1"></a>    <span class="op">});</span></span>
<span id="cb21-41"><a href="#cb21-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-42"><a href="#cb21-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> output<span class="op">;</span></span>
<span id="cb21-43"><a href="#cb21-43" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h3 id="declarative-composition">Declarative Composition</h3>
<p>Transformers compose naturally:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Chain multiple transformations</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> pipeline <span class="op">=</span> normalizer</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span>chain<span class="op">(</span>time_reverser<span class="op">)</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span>chain<span class="op">(</span>spectral_filter<span class="op">)</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span>chain<span class="op">(</span>fade_envelope<span class="op">);</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> result <span class="op">=</span> pipeline<span class="op">.</span>apply_operation<span class="op">(</span>input_data<span class="op">);</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a><span class="co">// Or use grammar-based automatic selection</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> adaptive_pipeline <span class="op">=</span> ComputationPipeline<span class="op">(</span>grammar<span class="op">)</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span>add_input<span class="op">(</span>input_data<span class="op">)</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span>with_context<span class="op">(</span>ComputationContext<span class="op">::</span>TEMPORAL<span class="op">)</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span>execute<span class="op">();</span></span></code></pre></div>
<p>The architecture enables adding new transformers without modifying
existing code, maintaining the <strong>open/closed principle</strong>
while providing declarative composition.</p>
<hr />
<h2 id="nddata-unified-cross-modal-processing">NDData: Unified
Cross-Modal Processing</h2>
<h3 id="the-problem-1">The Problem</h3>
<p>Traditional multimedia systems treat different data types as
separate:</p>
<ul>
<li>Audio: Samples in time</li>
<li>Images: Pixels in 2D space</li>
<li>Video: Frames over time</li>
<li>Spectral: Frequency over time</li>
<li>Tensors: N-dimensional arrays</li>
</ul>
<p>Each requires different APIs, different processing pipelines,
different transformation logic.</p>
<h3 id="the-solution-dimensional-abstraction">The Solution: Dimensional
Abstraction</h3>
<p>NDData provides <strong>unified dimensional access</strong>
regardless of data modality:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="kw">namespace</span> Kakshya <span class="op">{</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="co">// Unified data type</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> DataVariant <span class="op">=</span> <span class="bu">std::</span>variant<span class="op">&lt;</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span><span class="op">,</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>vector<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;,</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>vector<span class="op">&lt;</span><span class="bu">std::</span>vector<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;&gt;,</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>vector<span class="op">&lt;</span><span class="bu">std::</span>vector<span class="op">&lt;</span><span class="bu">std::</span>vector<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;&gt;&gt;,</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>string</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;;</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a><span class="co">// Dimensional descriptor</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> DataDimension <span class="op">{</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>string name<span class="op">;</span>           <span class="co">// &quot;time&quot;, &quot;frequency&quot;, &quot;x&quot;, &quot;y&quot;, &quot;channel&quot;</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>    <span class="dt">uint64_t</span> size<span class="op">;</span>              <span class="co">// Number of elements</span></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>    <span class="dt">uint64_t</span> stride<span class="op">;</span>            <span class="co">// Memory stride</span></span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>    DimensionType type<span class="op">;</span>         <span class="co">// TEMPORAL, SPATIAL, SPECTRAL, CHANNEL</span></span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>optional<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;</span> scale<span class="op">;</span> <span class="co">// Physical units conversion</span></span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a><span class="op">};</span></span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h3 id="data-modality-definitions">Data Modality Definitions</h3>
<div class="sourceCode" id="cb24"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="kw">enum</span> <span class="kw">class</span> DataModality <span class="op">{</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>    AUDIO_1D<span class="op">,</span>              <span class="co">// Single channel audio</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    AUDIO_MULTICHANNEL<span class="op">,</span>    <span class="co">// Multi-channel audio</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    SPECTRAL_2D<span class="op">,</span>           <span class="co">// Frequency x Time</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    IMAGE_2D<span class="op">,</span>              <span class="co">// Height x Width</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    IMAGE_RGB<span class="op">,</span>             <span class="co">// Height x Width x 3</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>    VIDEO_3D<span class="op">,</span>              <span class="co">// Height x Width x Time</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>    TENSOR_ND              <span class="co">// Arbitrary dimensions</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="op">};</span></span></code></pre></div>
<h3 id="creating-dimensional-data">Creating Dimensional Data</h3>
<div class="sourceCode" id="cb25"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Audio: 48000 samples</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> audio_module <span class="op">=</span> NDData<span class="op">::</span>create_audio_1d<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;(</span><span class="dv">48000</span><span class="op">);</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="co">// Multi-channel audio: 48000 samples x 2 channels</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> stereo_module <span class="op">=</span> NDData<span class="op">::</span>create_audio_multichannel<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;(</span><span class="dv">48000</span><span class="op">,</span> <span class="dv">2</span><span class="op">);</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="co">// Spectral data: 128 time windows x 1024 frequency bins</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> spectral_module <span class="op">=</span> NDData<span class="op">::</span>create_spectral_2d<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;(</span><span class="dv">128</span><span class="op">,</span> <span class="dv">1024</span><span class="op">);</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="co">// Image: 1920x1080 pixels</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> image_module <span class="op">=</span> NDData<span class="op">::</span>create_image_2d<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;(</span><span class="dv">1080</span><span class="op">,</span> <span class="dv">1920</span><span class="op">);</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a><span class="co">// Generic N-dimensional tensor</span></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> tensor_module <span class="op">=</span> NDData<span class="op">::</span>create_for_modality<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;(</span></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>    DataModality<span class="op">::</span>TENSOR_ND<span class="op">,</span></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span><span class="dv">256</span><span class="op">,</span> <span class="dv">256</span><span class="op">,</span> <span class="dv">64</span><span class="op">},</span>  <span class="co">// shape</span></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>    <span class="fl">0.0</span><span class="op">,</span>             <span class="co">// default value</span></span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>    MemoryLayout<span class="op">::</span>ROW_MAJOR</span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a><span class="op">);</span></span></code></pre></div>
<h3 id="unified-transformation-interface">Unified Transformation
Interface</h3>
<p>The same transformation operations work across modalities:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Mathematical operations work on any modality</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> normalized <span class="op">=</span> MathematicalTransformer<span class="op">(</span>MathOperation<span class="op">::</span>NORMALIZE<span class="op">)</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span>apply_operation<span class="op">(</span>audio_data<span class="op">);</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> normalized_image <span class="op">=</span> MathematicalTransformer<span class="op">(</span>MathOperation<span class="op">::</span>NORMALIZE<span class="op">)</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span>apply_operation<span class="op">(</span>image_data<span class="op">);</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="co">// Temporal operations on audio</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> reversed_audio <span class="op">=</span> TemporalTransformer<span class="op">(</span>TemporalOperation<span class="op">::</span>TIME_REVERSE<span class="op">)</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span>apply_operation<span class="op">(</span>audio_data<span class="op">);</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a><span class="co">// Temporal operations on video (time dimension)</span></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> reversed_video <span class="op">=</span> TemporalTransformer<span class="op">(</span>TemporalOperation<span class="op">::</span>TIME_REVERSE<span class="op">)</span></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span>apply_operation<span class="op">(</span>video_data<span class="op">);</span></span></code></pre></div>
<h3 id="region-based-access">Region-Based Access</h3>
<p>Regions enable precise data selection across dimensions:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Temporal region (audio)</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> intro <span class="op">=</span> Region<span class="op">::</span>audio_span<span class="op">(</span><span class="dv">0</span><span class="op">,</span> <span class="dv">6000</span><span class="op">,</span> <span class="dv">0</span><span class="op">);</span>  <span class="co">// First 0.125s, channel 0</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co">// Spatial region (image)</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> top_left <span class="op">=</span> Region<span class="op">::</span>image_rect<span class="op">(</span><span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">100</span><span class="op">,</span> <span class="dv">100</span><span class="op">);</span>  <span class="co">// 100x100 pixel region</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="co">// Spectral region</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> bass_range <span class="op">=</span> Region<span class="op">::</span>spectral_range<span class="op">(</span><span class="dv">0</span><span class="op">,</span> <span class="dv">100</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">512</span><span class="op">);</span>  <span class="co">// Low frequencies</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a><span class="co">// Multi-dimensional region (video)</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> clip <span class="op">=</span> Region<span class="op">::</span>video_clip<span class="op">(</span><span class="dv">0</span><span class="op">,</span> <span class="dv">100</span><span class="op">,</span> <span class="dv">50</span><span class="op">,</span> <span class="dv">150</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">30</span><span class="op">);</span>  <span class="co">// Spatial crop + temporal clip</span></span></code></pre></div>
<h3 id="container-integration">Container Integration</h3>
<p>NDimensionalContainers use regions for creative data
organization:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> NDimensionalContainer <span class="op">{</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span><span class="op">:</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Store region with metadata</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> add_region<span class="op">(</span><span class="at">const</span> <span class="bu">std::</span>string<span class="op">&amp;</span> name<span class="op">,</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">const</span> Region<span class="op">&amp;</span> region<span class="op">,</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">const</span> RegionMetadata<span class="op">&amp;</span> metadata<span class="op">);</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Extract data from region</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>    DataVariant get_region_data<span class="op">(</span><span class="at">const</span> Region<span class="op">&amp;</span> region<span class="op">);</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Modify region in place</span></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> set_region_data<span class="op">(</span><span class="at">const</span> Region<span class="op">&amp;</span> region<span class="op">,</span> <span class="at">const</span> DataVariant<span class="op">&amp;</span> data<span class="op">);</span></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Query regions by attributes</span></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>vector<span class="op">&lt;</span>Region<span class="op">&gt;</span> find_regions_with_attribute<span class="op">(</span></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">const</span> <span class="bu">std::</span>string<span class="op">&amp;</span> key<span class="op">,</span></span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">const</span> <span class="bu">std::</span>any<span class="op">&amp;</span> value<span class="op">);</span></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a><span class="op">};</span></span></code></pre></div>
<h3 id="cross-modal-workflow-example">Cross-Modal Workflow Example</h3>
<div class="sourceCode" id="cb29"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Load audio file</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> container <span class="op">=</span> SoundFileContainer<span class="op">::</span>from_file<span class="op">(</span><span class="st">&quot;audio.wav&quot;</span><span class="op">);</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="co">// Define analysis region</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> intro <span class="op">=</span> Region<span class="op">::</span>audio_span<span class="op">(</span><span class="dv">0</span><span class="op">,</span> <span class="dv">12000</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">);</span>  <span class="co">// Both channels</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="co">// Extract spectral content</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> spectral_transformer <span class="op">=</span> SpectralTransformer<span class="op">(</span>SpectralOperation<span class="op">::</span>FFT<span class="op">);</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> spectral_data <span class="op">=</span> spectral_transformer<span class="op">.</span>apply_operation<span class="op">(</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>    container<span class="op">-&gt;</span>get_region_data<span class="op">(</span>intro<span class="op">)</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a><span class="op">);</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a><span class="co">// Use spectral data to modulate visual parameters</span></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> visual_modulator <span class="op">=</span> <span class="op">[&amp;](</span><span class="at">const</span> SpectralData<span class="op">&amp;</span> spectrum<span class="op">)</span> <span class="op">{</span></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Map frequency energy to visual parameters</span></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> bass_energy <span class="op">=</span> spectrum<span class="op">.</span>energy_in_range<span class="op">(</span><span class="dv">20</span><span class="op">,</span> <span class="dv">200</span><span class="op">);</span></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> mid_energy <span class="op">=</span> spectrum<span class="op">.</span>energy_in_range<span class="op">(</span><span class="dv">200</span><span class="op">,</span> <span class="dv">2000</span><span class="op">);</span></span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Control visual buffer</span></span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>    visual_buffer<span class="op">-&gt;</span>set_parameter<span class="op">(</span><span class="st">&quot;hue_shift&quot;</span><span class="op">,</span> bass_energy <span class="op">*</span> <span class="fl">360.0</span><span class="op">);</span></span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>    visual_buffer<span class="op">-&gt;</span>set_parameter<span class="op">(</span><span class="st">&quot;brightness&quot;</span><span class="op">,</span> mid_energy <span class="op">*</span> <span class="fl">2.0</span><span class="op">);</span></span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a><span class="op">};</span></span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a><span class="co">// Coordinate via coroutine</span></span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> coordination <span class="op">=</span> Kriya<span class="op">::</span>metro<span class="op">(*</span>scheduler<span class="op">,</span> <span class="fl">0.1</span><span class="op">,</span> <span class="op">[&amp;]()</span> <span class="op">{</span></span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> current_spectrum <span class="op">=</span> analyze_current_frame<span class="op">(</span>audio_buffer<span class="op">);</span></span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a>    visual_modulator<span class="op">(</span>current_spectrum<span class="op">);</span></span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a><span class="op">});</span></span></code></pre></div>
<p>This demonstrates <strong>true cross-modal
coordination</strong>—audio analysis directly controlling visual
parameters through unified data abstractions.</p>
<hr />
<h2 id="window-management-as-coroutines">Window Management as
Coroutines</h2>
<p>MayaFlux reimagines windowing events as <strong>temporal coroutine
patterns</strong> rather than traditional callback spaghetti.</p>
<h3 id="traditional-windowing-callback-hell">Traditional Windowing:
Callback Hell</h3>
<div class="sourceCode" id="cb30"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Traditional GLFW approach - fragmented callback hell</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> key_callback<span class="op">(</span>GLFWwindow<span class="op">*</span> window<span class="op">,</span> <span class="dt">int</span> key<span class="op">,</span> <span class="dt">int</span> scancode<span class="op">,</span> <span class="dt">int</span> action<span class="op">,</span> <span class="dt">int</span> mods<span class="op">)</span> <span class="op">{</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>action <span class="op">==</span> GLFW_PRESS<span class="op">)</span> <span class="op">{</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>        handle_key_press<span class="op">(</span>key<span class="op">);</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> mouse_callback<span class="op">(</span>GLFWwindow<span class="op">*</span> window<span class="op">,</span> <span class="dt">double</span> xpos<span class="op">,</span> <span class="dt">double</span> ypos<span class="op">)</span> <span class="op">{</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>    handle_mouse_motion<span class="op">(</span>xpos<span class="op">,</span> ypos<span class="op">);</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> resize_callback<span class="op">(</span>GLFWwindow<span class="op">*</span> window<span class="op">,</span> <span class="dt">int</span> width<span class="op">,</span> <span class="dt">int</span> height<span class="op">)</span> <span class="op">{</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>    handle_resize<span class="op">(</span>width<span class="op">,</span> height<span class="op">);</span></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a><span class="co">// Separate callback registration</span></span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>glfwSetKeyCallback<span class="op">(</span>window<span class="op">,</span> key_callback<span class="op">);</span></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>glfwSetCursorPosCallback<span class="op">(</span>window<span class="op">,</span> mouse_callback<span class="op">);</span></span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>glfwSetWindowSizeCallback<span class="op">(</span>window<span class="op">,</span> resize_callback<span class="op">);</span></span></code></pre></div>
<p><strong>Problems:</strong></p>
<ul>
<li>State machine logic scattered across callbacks</li>
<li>Difficult to coordinate multi-event patterns</li>
<li>No natural sequencing or temporal coordination</li>
<li>Callback hell for complex interactions</li>
</ul>
<h3 id="mayaflux-approach-window-events-as-eventsource">MayaFlux
Approach: Window Events as EventSource</h3>
<p>Each window has an <code>EventSource</code> that signals events to
coroutines:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> GlfwWindow <span class="op">:</span> <span class="kw">public</span> IWindow <span class="op">{</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>    Vruta<span class="op">::</span>EventSource <span class="va">m_event_source</span><span class="op">;</span>  <span class="co">// Coroutine event signaling</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>    WindowEventCallback <span class="va">m_event_callback</span><span class="op">;</span>  <span class="co">// Traditional callback (optional)</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">// GLFW callbacks signal EventSource</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">static</span> <span class="dt">void</span> glfw_key_callback<span class="op">(</span>GLFWwindow<span class="op">*</span> window<span class="op">,</span> <span class="dt">int</span> key<span class="op">,</span> <span class="dt">int</span> scancode<span class="op">,</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>                                   <span class="dt">int</span> action<span class="op">,</span> <span class="dt">int</span> mods<span class="op">)</span> <span class="op">{</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span><span class="op">*</span> win <span class="op">=</span> <span class="kw">static_cast</span><span class="op">&lt;</span>GlfwWindow<span class="op">*&gt;(</span>glfwGetWindowUserPointer<span class="op">(</span>window<span class="op">));</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>        WindowEvent event<span class="op">;</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>        event<span class="op">.</span>type <span class="op">=</span> <span class="op">(</span>action <span class="op">==</span> GLFW_PRESS<span class="op">)</span> <span class="op">?</span> WindowEventType<span class="op">::</span>KEY_PRESSED</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>                                            <span class="op">:</span> WindowEventType<span class="op">::</span>KEY_RELEASED<span class="op">;</span></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>        event<span class="op">.</span>timestamp <span class="op">=</span> glfwGetTime<span class="op">();</span></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>        event<span class="op">.</span>data <span class="op">=</span> WindowEvent<span class="op">::</span>KeyData<span class="op">{</span>key<span class="op">,</span> scancode<span class="op">,</span> mods<span class="op">};</span></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Signal coroutines waiting on this event</span></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>        win<span class="op">-&gt;</span><span class="va">m_event_source</span><span class="op">.</span>signal<span class="op">(</span>event<span class="op">);</span></span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Optional: call traditional callback</span></span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>win<span class="op">-&gt;</span><span class="va">m_event_callback</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>            win<span class="op">-&gt;</span><span class="va">m_event_callback</span><span class="op">(</span>event<span class="op">);</span></span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a><span class="op">};</span></span></code></pre></div>
<h3 id="coroutine-event-patterns">Coroutine Event Patterns</h3>
<h4 id="awaiting-specific-events">Awaiting Specific Events</h4>
<div class="sourceCode" id="cb32"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Wait for specific window event</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>Task<span class="op">&lt;</span><span class="dt">void</span><span class="op">&gt;</span> handle_user_input<span class="op">(</span>GlfwWindow<span class="op">&amp;</span> window<span class="op">)</span> <span class="op">{</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span><span class="kw">true</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Await next keyboard event</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> event <span class="op">=</span> <span class="cf">co_await</span> window<span class="op">.</span>event_source<span class="op">().</span>next_event<span class="op">(</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>            WindowEventType<span class="op">::</span>KEY_PRESSED</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>        <span class="op">);</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> key_data <span class="op">=</span> <span class="bu">std::</span>get<span class="op">&lt;</span>WindowEvent<span class="op">::</span>KeyData<span class="op">&gt;(</span>event<span class="op">.</span>data<span class="op">);</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>key_data<span class="op">.</span>key <span class="op">==</span> GLFW_KEY_SPACE<span class="op">)</span> <span class="op">{</span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>            trigger_audio_event<span class="op">();</span></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span> <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>key_data<span class="op">.</span>key <span class="op">==</span> GLFW_KEY_ESCAPE<span class="op">)</span> <span class="op">{</span></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span><span class="op">;</span></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h4 id="event-sequencing">Event Sequencing</h4>
<div class="sourceCode" id="cb33"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Wait for event sequence</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>Task<span class="op">&lt;</span><span class="dt">void</span><span class="op">&gt;</span> gesture_recognition<span class="op">(</span>GlfwWindow<span class="op">&amp;</span> window<span class="op">)</span> <span class="op">{</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Wait for mouse button press</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> press_event <span class="op">=</span> <span class="cf">co_await</span> window<span class="op">.</span>event_source<span class="op">().</span>next_event<span class="op">(</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>        WindowEventType<span class="op">::</span>MOUSE_BUTTON_PRESSED</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">);</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> start_time <span class="op">=</span> press_event<span class="op">.</span>timestamp<span class="op">;</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> start_pos <span class="op">=</span> <span class="bu">std::</span>get<span class="op">&lt;</span>WindowEvent<span class="op">::</span>MouseButtonData<span class="op">&gt;(</span>press_event<span class="op">.</span>data<span class="op">);</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Track mouse motion</span></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>vector<span class="op">&lt;</span>Vector2<span class="op">&gt;</span> gesture_path<span class="op">;</span></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span><span class="kw">true</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> event <span class="op">=</span> <span class="cf">co_await</span> window<span class="op">.</span>event_source<span class="op">().</span>next_event<span class="op">();</span></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>event<span class="op">.</span>type <span class="op">==</span> WindowEventType<span class="op">::</span>MOUSE_MOTION<span class="op">)</span> <span class="op">{</span></span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>            <span class="kw">auto</span> pos <span class="op">=</span> <span class="bu">std::</span>get<span class="op">&lt;</span>WindowEvent<span class="op">::</span>MousePosData<span class="op">&gt;(</span>event<span class="op">.</span>data<span class="op">);</span></span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>            gesture_path<span class="op">.</span>push_back<span class="op">({</span>pos<span class="op">.</span>x<span class="op">,</span> pos<span class="op">.</span>y<span class="op">});</span></span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>event<span class="op">.</span>type <span class="op">==</span> WindowEventType<span class="op">::</span>MOUSE_BUTTON_RELEASED<span class="op">)</span> <span class="op">{</span></span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a>            <span class="co">// Analyze complete gesture</span></span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a>            recognize_gesture<span class="op">(</span>gesture_path<span class="op">);</span></span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span><span class="op">;</span></span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h4 id="event-driven-audio-visual-coordination">Event-Driven
Audio-Visual Coordination</h4>
<div class="sourceCode" id="cb34"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Coordinate audio triggering with window focus</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>Task<span class="op">&lt;</span><span class="dt">void</span><span class="op">&gt;</span> focus_aware_processing<span class="op">(</span>GlfwWindow<span class="op">&amp;</span> window<span class="op">)</span> <span class="op">{</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span><span class="kw">true</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> event <span class="op">=</span> <span class="cf">co_await</span> window<span class="op">.</span>event_source<span class="op">().</span>next_event<span class="op">();</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>event<span class="op">.</span>type <span class="op">==</span> WindowEventType<span class="op">::</span>WINDOW_FOCUS_GAINED<span class="op">)</span> <span class="op">{</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>            <span class="co">// Resume audio processing</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>            audio_graph_manager<span class="op">-&gt;</span>set_processing_enabled<span class="op">(</span><span class="kw">true</span><span class="op">);</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>            visual_renderer<span class="op">-&gt;</span>set_render_quality<span class="op">(</span>RenderQuality<span class="op">::</span>HIGH<span class="op">);</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>event<span class="op">.</span>type <span class="op">==</span> WindowEventType<span class="op">::</span>WINDOW_FOCUS_LOST<span class="op">)</span> <span class="op">{</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>            <span class="co">// Pause audio processing</span></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>            audio_graph_manager<span class="op">-&gt;</span>set_processing_enabled<span class="op">(</span><span class="kw">false</span><span class="op">);</span></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>            visual_renderer<span class="op">-&gt;</span>set_render_quality<span class="op">(</span>RenderQuality<span class="op">::</span>LOW<span class="op">);</span></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>event<span class="op">.</span>type <span class="op">==</span> WindowEventType<span class="op">::</span>WINDOW_RESIZED<span class="op">)</span> <span class="op">{</span></span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>            <span class="kw">auto</span> resize <span class="op">=</span> <span class="bu">std::</span>get<span class="op">&lt;</span>WindowEvent<span class="op">::</span>ResizeData<span class="op">&gt;(</span>event<span class="op">.</span>data<span class="op">);</span></span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>            handle_viewport_resize<span class="op">(</span>resize<span class="op">.</span>width<span class="op">,</span> resize<span class="op">.</span>height<span class="op">);</span></span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h4 id="multi-window-coordination">Multi-Window Coordination</h4>
<div class="sourceCode" id="cb35"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Coordinate events across multiple windows</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>Task<span class="op">&lt;</span><span class="dt">void</span><span class="op">&gt;</span> multi_window_sync<span class="op">(</span>GlfwWindow<span class="op">&amp;</span> main_window<span class="op">,</span> GlfwWindow<span class="op">&amp;</span> control_window<span class="op">)</span> <span class="op">{</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span><span class="kw">true</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Wait for events from either window</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> event <span class="op">=</span> <span class="cf">co_await</span> EventSource<span class="op">::</span>any_of<span class="op">({</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>            main_window<span class="op">.</span>event_source<span class="op">(),</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>            control_window<span class="op">.</span>event_source<span class="op">()</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>        <span class="op">});</span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Synchronize state across windows</span></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>event<span class="op">.</span>type <span class="op">==</span> WindowEventType<span class="op">::</span>KEY_PRESSED<span class="op">)</span> <span class="op">{</span></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>            <span class="co">// Broadcast key event to both visual contexts</span></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>            main_window<span class="op">.</span>dispatch_event<span class="op">(</span>event<span class="op">);</span></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>            control_window<span class="op">.</span>dispatch_event<span class="op">(</span>event<span class="op">);</span></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h3 id="eventsource-architecture">EventSource Architecture</h3>
<div class="sourceCode" id="cb36"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="kw">namespace</span> Vruta <span class="op">{</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> EventSource <span class="op">{</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>queue<span class="op">&lt;</span>WindowEvent<span class="op">&gt;</span> <span class="va">m_event_queue</span><span class="op">;</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>vector<span class="op">&lt;</span><span class="bu">std::</span>coroutine_handle<span class="op">&lt;&gt;&gt;</span> <span class="va">m_waiting_coroutines</span><span class="op">;</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>mutex <span class="va">m_mutex</span><span class="op">;</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span><span class="op">:</span></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Signal event from callback</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> signal<span class="op">(</span><span class="at">const</span> WindowEvent<span class="op">&amp;</span> event<span class="op">)</span> <span class="op">{</span></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>lock_guard lock<span class="op">(</span><span class="va">m_mutex</span><span class="op">);</span></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>        <span class="va">m_event_queue</span><span class="op">.</span>push<span class="op">(</span>event<span class="op">);</span></span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Resume all waiting coroutines</span></span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="kw">auto</span><span class="op">&amp;</span> handle <span class="op">:</span> <span class="va">m_waiting_coroutines</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>            handle<span class="op">.</span>resume<span class="op">();</span></span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>        <span class="va">m_waiting_coroutines</span><span class="op">.</span>clear<span class="op">();</span></span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Awaitable for next event</span></span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> next_event<span class="op">(</span><span class="bu">std::</span>optional<span class="op">&lt;</span>WindowEventType<span class="op">&gt;</span> filter <span class="op">=</span> <span class="bu">std::</span>nullopt<span class="op">)</span> <span class="op">{</span></span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a>        <span class="kw">struct</span> EventAwaiter <span class="op">{</span></span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a>            EventSource<span class="op">&amp;</span> source<span class="op">;</span></span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a>            <span class="bu">std::</span>optional<span class="op">&lt;</span>WindowEventType<span class="op">&gt;</span> filter<span class="op">;</span></span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a>            WindowEvent result<span class="op">;</span></span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-28"><a href="#cb36-28" aria-hidden="true" tabindex="-1"></a>            <span class="dt">bool</span> await_ready<span class="op">()</span> <span class="op">{</span></span>
<span id="cb36-29"><a href="#cb36-29" aria-hidden="true" tabindex="-1"></a>                <span class="bu">std::</span>lock_guard lock<span class="op">(</span>source<span class="op">.</span><span class="va">m_mutex</span><span class="op">);</span></span>
<span id="cb36-30"><a href="#cb36-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-31"><a href="#cb36-31" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="op">(</span>source<span class="op">.</span><span class="va">m_event_queue</span><span class="op">.</span>empty<span class="op">())</span> <span class="op">{</span></span>
<span id="cb36-32"><a href="#cb36-32" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb36-33"><a href="#cb36-33" aria-hidden="true" tabindex="-1"></a>                <span class="op">}</span></span>
<span id="cb36-34"><a href="#cb36-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-35"><a href="#cb36-35" aria-hidden="true" tabindex="-1"></a>                <span class="co">// Check if event matches filter</span></span>
<span id="cb36-36"><a href="#cb36-36" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="op">(</span>filter <span class="op">&amp;&amp;</span> source<span class="op">.</span><span class="va">m_event_queue</span><span class="op">.</span>front<span class="op">().</span>type <span class="op">!=</span> <span class="op">*</span>filter<span class="op">)</span> <span class="op">{</span></span>
<span id="cb36-37"><a href="#cb36-37" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb36-38"><a href="#cb36-38" aria-hidden="true" tabindex="-1"></a>                <span class="op">}</span></span>
<span id="cb36-39"><a href="#cb36-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-40"><a href="#cb36-40" aria-hidden="true" tabindex="-1"></a>                result <span class="op">=</span> source<span class="op">.</span><span class="va">m_event_queue</span><span class="op">.</span>front<span class="op">();</span></span>
<span id="cb36-41"><a href="#cb36-41" aria-hidden="true" tabindex="-1"></a>                source<span class="op">.</span><span class="va">m_event_queue</span><span class="op">.</span>pop<span class="op">();</span></span>
<span id="cb36-42"><a href="#cb36-42" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb36-43"><a href="#cb36-43" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb36-44"><a href="#cb36-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-45"><a href="#cb36-45" aria-hidden="true" tabindex="-1"></a>            <span class="dt">void</span> await_suspend<span class="op">(</span><span class="bu">std::</span>coroutine_handle<span class="op">&lt;&gt;</span> handle<span class="op">)</span> <span class="op">{</span></span>
<span id="cb36-46"><a href="#cb36-46" aria-hidden="true" tabindex="-1"></a>                <span class="bu">std::</span>lock_guard lock<span class="op">(</span>source<span class="op">.</span><span class="va">m_mutex</span><span class="op">);</span></span>
<span id="cb36-47"><a href="#cb36-47" aria-hidden="true" tabindex="-1"></a>                source<span class="op">.</span><span class="va">m_waiting_coroutines</span><span class="op">.</span>push_back<span class="op">(</span>handle<span class="op">);</span></span>
<span id="cb36-48"><a href="#cb36-48" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb36-49"><a href="#cb36-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-50"><a href="#cb36-50" aria-hidden="true" tabindex="-1"></a>            WindowEvent await_resume<span class="op">()</span> <span class="op">{</span> <span class="cf">return</span> result<span class="op">;</span> <span class="op">}</span></span>
<span id="cb36-51"><a href="#cb36-51" aria-hidden="true" tabindex="-1"></a>        <span class="op">};</span></span>
<span id="cb36-52"><a href="#cb36-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-53"><a href="#cb36-53" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> EventAwaiter<span class="op">{*</span><span class="kw">this</span><span class="op">,</span> filter<span class="op">};</span></span>
<span id="cb36-54"><a href="#cb36-54" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb36-55"><a href="#cb36-55" aria-hidden="true" tabindex="-1"></a><span class="op">};</span></span>
<span id="cb36-56"><a href="#cb36-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-57"><a href="#cb36-57" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h3 id="window-processing-token">Window Processing Token</h3>
<p>Windows have their own processing token for domain coordination:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Domain definition for windowing</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>Domain<span class="op">::</span>WINDOWING <span class="op">=</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">(</span>Nodes<span class="op">::</span>ProcessingToken<span class="op">::</span>VISUAL_RATE <span class="op">&lt;&lt;</span> <span class="dv">32</span><span class="op">)</span> <span class="op">|</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">(</span>Buffers<span class="op">::</span>ProcessingToken<span class="op">::</span>WINDOW_EVENTS <span class="op">&lt;&lt;</span> <span class="dv">16</span><span class="op">)</span> <span class="op">|</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">(</span>Vruta<span class="op">::</span>ProcessingToken<span class="op">::</span>FRAME_ACCURATE<span class="op">);</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a><span class="co">// Window event buffer processes at frame rate</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> window_buffer <span class="op">=</span> BufferManager<span class="op">::</span>create_buffer<span class="op">(</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>    BufferType<span class="op">::</span>WINDOW_EVENT<span class="op">,</span></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>    Domain<span class="op">::</span>WINDOWING</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a><span class="op">);</span></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a><span class="co">// Coordinate window events with visual nodes</span></span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> window_node <span class="op">=</span> vega<span class="op">.</span>window_events<span class="op">()</span> <span class="op">|</span> Domain<span class="op">::</span>WINDOWING<span class="op">;</span></span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>window_node <span class="op">&gt;&gt;</span> visual_buffer <span class="op">&gt;&gt;</span> renderer<span class="op">;</span></span></code></pre></div>
<p>This architecture transforms window management from <strong>callback
spaghetti</strong> into <strong>expressive temporal
coordination</strong>, enabling patterns like gesture recognition,
multi-event sequences, and cross-window synchronization through natural
coroutine control flow.</p>
<hr />
<h2 id="domain-composition-and-processing-tokens">Domain Composition and
Processing Tokens</h2>
<h3 id="the-token-system">The Token System</h3>
<p>MayaFlux uses <strong>bitfield-composed tokens</strong> to specify
processing characteristics:</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Node processing tokens</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="kw">namespace</span> Nodes <span class="op">{</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">enum</span> <span class="kw">class</span> ProcessingToken <span class="op">{</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>        AUDIO_RATE<span class="op">,</span>    <span class="co">// Process at audio sample rate</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>        VISUAL_RATE<span class="op">,</span>   <span class="co">// Process at visual frame rate</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>        CUSTOM_RATE    <span class="co">// User-defined processing rate</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a><span class="co">// Buffer processing tokens (bitfield)</span></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a><span class="kw">namespace</span> Buffers <span class="op">{</span></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">enum</span> ProcessingToken <span class="op">:</span> <span class="dt">uint32_t</span> <span class="op">{</span></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Rate tokens</span></span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>        SAMPLE_RATE <span class="op">=</span> <span class="dv">1</span> <span class="op">&lt;&lt;</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>        FRAME_RATE <span class="op">=</span> <span class="dv">1</span> <span class="op">&lt;&lt;</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Device tokens</span></span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>        CPU_PROCESS <span class="op">=</span> <span class="dv">1</span> <span class="op">&lt;&lt;</span> <span class="dv">8</span><span class="op">,</span></span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>        GPU_PROCESS <span class="op">=</span> <span class="dv">1</span> <span class="op">&lt;&lt;</span> <span class="dv">9</span><span class="op">,</span></span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Concurrency tokens</span></span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a>        SEQUENTIAL <span class="op">=</span> <span class="dv">1</span> <span class="op">&lt;&lt;</span> <span class="dv">16</span><span class="op">,</span></span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a>        PARALLEL <span class="op">=</span> <span class="dv">1</span> <span class="op">&lt;&lt;</span> <span class="dv">17</span><span class="op">,</span></span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Backend combinations</span></span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true" tabindex="-1"></a>        AUDIO_BACKEND <span class="op">=</span> SAMPLE_RATE <span class="op">|</span> CPU_PROCESS <span class="op">|</span> SEQUENTIAL<span class="op">,</span></span>
<span id="cb38-27"><a href="#cb38-27" aria-hidden="true" tabindex="-1"></a>        GRAPHICS_BACKEND <span class="op">=</span> FRAME_RATE <span class="op">|</span> GPU_PROCESS <span class="op">|</span> PARALLEL<span class="op">,</span></span>
<span id="cb38-28"><a href="#cb38-28" aria-hidden="true" tabindex="-1"></a>        AUDIO_PARALLEL <span class="op">=</span> SAMPLE_RATE <span class="op">|</span> GPU_PROCESS <span class="op">|</span> PARALLEL<span class="op">,</span></span>
<span id="cb38-29"><a href="#cb38-29" aria-hidden="true" tabindex="-1"></a>        WINDOW_EVENTS <span class="op">=</span> FRAME_RATE <span class="op">|</span> CPU_PROCESS <span class="op">|</span> SEQUENTIAL</span>
<span id="cb38-30"><a href="#cb38-30" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb38-31"><a href="#cb38-31" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb38-32"><a href="#cb38-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-33"><a href="#cb38-33" aria-hidden="true" tabindex="-1"></a><span class="co">// Coroutine processing tokens</span></span>
<span id="cb38-34"><a href="#cb38-34" aria-hidden="true" tabindex="-1"></a><span class="kw">namespace</span> Vruta <span class="op">{</span></span>
<span id="cb38-35"><a href="#cb38-35" aria-hidden="true" tabindex="-1"></a>    <span class="kw">enum</span> <span class="kw">class</span> ProcessingToken <span class="op">{</span></span>
<span id="cb38-36"><a href="#cb38-36" aria-hidden="true" tabindex="-1"></a>        SAMPLE_ACCURATE<span class="op">,</span>  <span class="co">// Sample-level temporal precision</span></span>
<span id="cb38-37"><a href="#cb38-37" aria-hidden="true" tabindex="-1"></a>        FRAME_ACCURATE<span class="op">,</span>   <span class="co">// Frame-level temporal precision</span></span>
<span id="cb38-38"><a href="#cb38-38" aria-hidden="true" tabindex="-1"></a>        EVENT_DRIVEN<span class="op">,</span>     <span class="co">// Sporadic event processing</span></span>
<span id="cb38-39"><a href="#cb38-39" aria-hidden="true" tabindex="-1"></a>        MULTI_RATE<span class="op">,</span>       <span class="co">// Adapt between multiple rates</span></span>
<span id="cb38-40"><a href="#cb38-40" aria-hidden="true" tabindex="-1"></a>        ON_DEMAND<span class="op">,</span>        <span class="co">// Execute when explicitly called</span></span>
<span id="cb38-41"><a href="#cb38-41" aria-hidden="true" tabindex="-1"></a>        CUSTOM</span>
<span id="cb38-42"><a href="#cb38-42" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb38-43"><a href="#cb38-43" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h3 id="domain-composition">Domain Composition</h3>
<p>Domains combine tokens into unified computational contexts:</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="kw">enum</span> <span class="kw">class</span> Domain <span class="op">:</span> <span class="dt">uint64_t</span> <span class="op">{</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Audio processing with sample-accurate coordination</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>    AUDIO <span class="op">=</span> <span class="op">(</span>Nodes<span class="op">::</span>ProcessingToken<span class="op">::</span>AUDIO_RATE <span class="op">&lt;&lt;</span> <span class="dv">32</span><span class="op">)</span> <span class="op">|</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>            <span class="op">(</span>Buffers<span class="op">::</span>ProcessingToken<span class="op">::</span>AUDIO_BACKEND <span class="op">&lt;&lt;</span> <span class="dv">16</span><span class="op">)</span> <span class="op">|</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>            <span class="op">(</span>Vruta<span class="op">::</span>ProcessingToken<span class="op">::</span>SAMPLE_ACCURATE<span class="op">),</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Graphics with frame-accurate synchronization</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>    GRAPHICS <span class="op">=</span> <span class="op">(</span>Nodes<span class="op">::</span>ProcessingToken<span class="op">::</span>VISUAL_RATE <span class="op">&lt;&lt;</span> <span class="dv">32</span><span class="op">)</span> <span class="op">|</span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>               <span class="op">(</span>Buffers<span class="op">::</span>ProcessingToken<span class="op">::</span>GRAPHICS_BACKEND <span class="op">&lt;&lt;</span> <span class="dv">16</span><span class="op">)</span> <span class="op">|</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>               <span class="op">(</span>Vruta<span class="op">::</span>ProcessingToken<span class="op">::</span>FRAME_ACCURATE<span class="op">),</span></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>    <span class="co">// GPU-accelerated audio processing</span></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>    AUDIO_GPU <span class="op">=</span> <span class="op">(</span>Nodes<span class="op">::</span>ProcessingToken<span class="op">::</span>AUDIO_RATE <span class="op">&lt;&lt;</span> <span class="dv">32</span><span class="op">)</span> <span class="op">|</span></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>                <span class="op">(</span>Buffers<span class="op">::</span>ProcessingToken<span class="op">::</span>AUDIO_PARALLEL <span class="op">&lt;&lt;</span> <span class="dv">16</span><span class="op">)</span> <span class="op">|</span></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>                <span class="op">(</span>Vruta<span class="op">::</span>ProcessingToken<span class="op">::</span>MULTI_RATE<span class="op">),</span></span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Windowing without rendering</span></span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>    WINDOWING <span class="op">=</span> <span class="op">(</span>Nodes<span class="op">::</span>ProcessingToken<span class="op">::</span>VISUAL_RATE <span class="op">&lt;&lt;</span> <span class="dv">32</span><span class="op">)</span> <span class="op">|</span></span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a>                <span class="op">(</span>Buffers<span class="op">::</span>ProcessingToken<span class="op">::</span>WINDOW_EVENTS <span class="op">&lt;&lt;</span> <span class="dv">16</span><span class="op">)</span> <span class="op">|</span></span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a>                <span class="op">(</span>Vruta<span class="op">::</span>ProcessingToken<span class="op">::</span>FRAME_ACCURATE<span class="op">),</span></span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Input event processing</span></span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a>    INPUT <span class="op">=</span> <span class="op">(</span>Nodes<span class="op">::</span>ProcessingToken<span class="op">::</span>VISUAL_RATE <span class="op">&lt;&lt;</span> <span class="dv">32</span><span class="op">)</span> <span class="op">|</span></span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a>            <span class="op">(</span>Buffers<span class="op">::</span>ProcessingToken<span class="op">::</span>FRAME_RATE <span class="op">&lt;&lt;</span> <span class="dv">16</span><span class="op">)</span> <span class="op">|</span></span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a>            <span class="op">(</span>Vruta<span class="op">::</span>ProcessingToken<span class="op">::</span>EVENT_DRIVEN<span class="op">)</span></span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a><span class="op">};</span></span></code></pre></div>
<h3 id="domain-decomposition">Domain Decomposition</h3>
<p>Extract individual tokens from composed domains:</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Helper functions for token extraction</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> Nodes<span class="op">::</span>ProcessingToken get_node_token<span class="op">(</span>Domain domain<span class="op">)</span> <span class="op">{</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="kw">static_cast</span><span class="op">&lt;</span>Nodes<span class="op">::</span>ProcessingToken<span class="op">&gt;((</span><span class="dt">uint64_t</span><span class="op">)</span>domain <span class="op">&gt;&gt;</span> <span class="dv">32</span><span class="op">);</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> Buffers<span class="op">::</span>ProcessingToken get_buffer_token<span class="op">(</span>Domain domain<span class="op">)</span> <span class="op">{</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="kw">static_cast</span><span class="op">&lt;</span>Buffers<span class="op">::</span>ProcessingToken<span class="op">&gt;(((</span><span class="dt">uint64_t</span><span class="op">)</span>domain <span class="op">&gt;&gt;</span> <span class="dv">16</span><span class="op">)</span> <span class="op">&amp;</span> <span class="bn">0xFFFF</span><span class="op">);</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> Vruta<span class="op">::</span>ProcessingToken get_task_token<span class="op">(</span>Domain domain<span class="op">)</span> <span class="op">{</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="kw">static_cast</span><span class="op">&lt;</span>Vruta<span class="op">::</span>ProcessingToken<span class="op">&gt;((</span><span class="dt">uint64_t</span><span class="op">)</span>domain <span class="op">&amp;</span> <span class="bn">0xFFFF</span><span class="op">);</span></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a><span class="co">// Create custom domain from individual tokens</span></span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>Domain compose_domain<span class="op">(</span>Nodes<span class="op">::</span>ProcessingToken node_token<span class="op">,</span></span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>                     Buffers<span class="op">::</span>ProcessingToken buffer_token<span class="op">,</span></span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>                     Vruta<span class="op">::</span>ProcessingToken task_token<span class="op">)</span> <span class="op">{</span></span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="kw">static_cast</span><span class="op">&lt;</span>Domain<span class="op">&gt;(</span></span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a>        <span class="op">(</span><span class="kw">static_cast</span><span class="op">&lt;</span><span class="dt">uint64_t</span><span class="op">&gt;(</span>node_token<span class="op">)</span> <span class="op">&lt;&lt;</span> <span class="dv">32</span><span class="op">)</span> <span class="op">|</span></span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a>        <span class="op">(</span><span class="kw">static_cast</span><span class="op">&lt;</span><span class="dt">uint64_t</span><span class="op">&gt;(</span>buffer_token<span class="op">)</span> <span class="op">&lt;&lt;</span> <span class="dv">16</span><span class="op">)</span> <span class="op">|</span></span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a>        <span class="kw">static_cast</span><span class="op">&lt;</span><span class="dt">uint64_t</span><span class="op">&gt;(</span>task_token<span class="op">)</span></span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">);</span></span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h3 id="cross-domain-coordination">Cross-Domain Coordination</h3>
<div class="sourceCode" id="cb41"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Audio-visual synchronization domain</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> sync_domain <span class="op">=</span> Domain<span class="op">::</span>AUDIO_VISUAL_SYNC<span class="op">;</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="co">// Create nodes in synchronized domain</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> spectral_node <span class="op">=</span> vega<span class="op">.</span>fft<span class="op">()</span> <span class="op">|</span> sync_domain<span class="op">;</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> visual_buffer <span class="op">=</span> graphics_buffer <span class="op">|</span> sync_domain<span class="op">;</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a><span class="co">// Data flows between temporal contexts with coordination</span></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>spectral_node <span class="op">&gt;&gt;</span> visual_buffer<span class="op">;</span></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a><span class="co">// Coroutine coordinates across domains</span></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> coordination_routine <span class="op">=</span> Kriya<span class="op">::</span>metro<span class="op">(*</span>scheduler<span class="op">,</span> <span class="fl">0.1</span><span class="op">,</span> <span class="op">[&amp;]()</span> <span class="op">{</span></span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> spectral_data <span class="op">=</span> spectral_node<span class="op">-&gt;</span>get_current_output<span class="op">();</span></span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>    visual_buffer<span class="op">-&gt;</span>apply_modulation<span class="op">(</span>spectral_data<span class="op">);</span></span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a><span class="op">});</span></span></code></pre></div>
<h3 id="processing-handle-access">Processing Handle Access</h3>
<p>SubsystemManager provides token-scoped access:</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> SubsystemManager <span class="op">{</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Get processing handle for specific domain</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>    SubsystemProcessingHandle get_processing_handle<span class="op">(</span>Domain domain<span class="op">)</span> <span class="op">{</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> node_token <span class="op">=</span> get_node_token<span class="op">(</span>domain<span class="op">);</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> buffer_token <span class="op">=</span> get_buffer_token<span class="op">(</span>domain<span class="op">);</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> task_token <span class="op">=</span> get_task_token<span class="op">(</span>domain<span class="op">);</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> SubsystemProcessingHandle<span class="op">{</span></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span>nodes <span class="op">=</span> <span class="va">m_node_manager</span><span class="op">-&gt;</span>get_token_processor<span class="op">(</span>node_token<span class="op">),</span></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span>buffers <span class="op">=</span> <span class="va">m_buffer_manager</span><span class="op">-&gt;</span>get_token_processor<span class="op">(</span>buffer_token<span class="op">),</span></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span>tasks <span class="op">=</span> <span class="va">m_scheduler</span><span class="op">-&gt;</span>get_token_processor<span class="op">(</span>task_token<span class="op">)</span></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>        <span class="op">};</span></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a><span class="op">};</span></span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a><span class="co">// Usage</span></span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> handle <span class="op">=</span> subsystem_manager<span class="op">-&gt;</span>get_processing_handle<span class="op">(</span>Domain<span class="op">::</span>AUDIO<span class="op">);</span></span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>handle<span class="op">.</span>nodes<span class="op">.</span>process_channel<span class="op">(</span><span class="dv">0</span><span class="op">,</span> <span class="dv">512</span><span class="op">);</span>  <span class="co">// Process channel 0, 512 samples</span></span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>handle<span class="op">.</span>buffers<span class="op">.</span>process_all_buffers<span class="op">(</span><span class="dv">512</span><span class="op">);</span></span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a>handle<span class="op">.</span>tasks<span class="op">.</span>process<span class="op">(</span><span class="dv">512</span><span class="op">);</span></span></code></pre></div>
<p>This <strong>token composition architecture</strong> enables flexible
domain creation while maintaining type-safe processing coordination
across nodes, buffers, and coroutines.</p>
<hr />
<h2 id="current-implementation-status">Current Implementation
Status</h2>
<h3 id="fully-functional-tested">Fully Functional &amp; Tested</h3>
<p><strong>Lock-Free Processing</strong> ✓</p>
<ul>
<li>RootNode atomic registration and processing</li>
<li>NodeGraphManager concurrent coordination</li>
<li>BufferManager atomic accumulation</li>
<li>300+ tests validating lock-free patterns</li>
</ul>
<p><strong>Coroutine Infrastructure</strong> ✓</p>
<ul>
<li>TaskScheduler with clock coordination</li>
<li>SampleClock (passive) and FrameClock (active)</li>
<li>Vruta scheduling primitives</li>
<li>Kriya creative patterns (metro, timer, patterns)</li>
<li>150+ tests validating temporal coordination</li>
</ul>
<p><strong>Audio Backend</strong> ✓</p>
<ul>
<li>RtAudio integration</li>
<li>Multi-channel routing</li>
<li>Sample-accurate processing</li>
<li>Backend abstraction (pluggable)</li>
</ul>
<p><strong>Windowing System</strong> ✓</p>
<ul>
<li>GLFW integration with EventSource</li>
<li>Window event coroutines</li>
<li>Multi-window support</li>
<li>Input handling via coroutine patterns</li>
</ul>
<p><strong>Node System</strong> ✓</p>
<ul>
<li>Generator nodes (sine, noise, impulse, polynomial)</li>
<li>Processing nodes (IIR filters, gain, chain)</li>
<li>Lock-free registration and channel routing</li>
<li>Fluent operators (<code>&gt;&gt;</code>, <code>*</code>,
<code>+</code>)</li>
<li>180+ tests</li>
</ul>
<p><strong>Buffer System</strong> ✓</p>
<ul>
<li>AudioBuffer with processing chains</li>
<li>Custom processor extensibility</li>
<li>Shared data coordination</li>
<li>Token-based domain assignment</li>
<li>100+ tests</li>
</ul>
<p><strong>ComputationGrammar Foundation</strong> ✓</p>
<ul>
<li>Rule-based matching system</li>
<li>UniversalMatcher combinators</li>
<li>ExecutionContext infrastructure</li>
<li>Priority-based rule evaluation</li>
<li>80+ tests for core functionality</li>
</ul>
<p><strong>NDData Abstractions</strong> ✓</p>
<ul>
<li>DataVariant type system</li>
<li>DataDimension descriptors</li>
<li>Modality definitions (Audio, Spectral, Image, Video)</li>
<li>Region-based access patterns</li>
<li>90+ tests</li>
</ul>
<h3 id="in-active-development">In Active Development</h3>
<p><strong>Graphics Pipeline</strong> ⚙</p>
<ul>
<li>Architecture designed (compute shaders, render passes)</li>
<li>Synchronization with audio via coroutines</li>
<li>Integration stubs present</li>
<li>Full implementation pending</li>
<li>Pending OpenGL import from another project</li>
<li>Basic vulkan implemenation</li>
</ul>
<p><strong>ComputationGrammar Stress Testing</strong> ⚙</p>
<ul>
<li>Core functionality operational</li>
<li>Complex rule interactions untested</li>
<li>Real-world pipeline validation pending</li>
<li>Grammar-based adaptive pipelines experimental</li>
</ul>
<p><strong>Yantra Transformers</strong> ⚙</p>
<ul>
<li>Architecture solid (UniversalTransformer hierarchy)</li>
<li>Mathematical operations functional</li>
<li>Temporal operations functional</li>
<li>Spectral operations (basic FFT via FFTW) functional</li>
<li>Advanced algorithms (phase vocoder, granular) planned</li>
</ul>
<p><strong>Inter-Component Integration</strong> ⚙</p>
<ul>
<li>Component-level tests ~700 total</li>
<li>Cross-component stress testing ~40% coverage</li>
<li>Real-world creative validation limited</li>
<li>Production stability unknown</li>
</ul>
<h3 id="planned-expansions">Planned Expansions</h3>
<p><strong>Live Coding Integration</strong></p>
<ul>
<li>Lua via Sol2 (potential)</li>
<li>LLVM OCR JIT</li>
<li>Runtime code modification</li>
</ul>
<p><strong>Game Engine Plugins</strong></p>
<ul>
<li>UE5 C++ bindings</li>
<li>Godot C++ bindings</li>
<li>Real-time audio-visual coordination</li>
</ul>
<hr />
<h2 id="future-vision-and-expansion">Future Vision and Expansion</h2>
<h3 id="the-pluggable-philosophy">The Pluggable Philosophy</h3>
<p>MayaFlux is designed for <strong>complete extensibility</strong>:</p>
<ul>
<li><strong>Live Coding</strong> Runtime modification of processing
graphs</li>
<li><strong>UE5/Godot</strong>: Game engine audio-visual
coordination</li>
<li><strong>Custom Backends</strong>: Quantum, neural, biomimetic
processing</li>
</ul>
<h3 id="beyond-traditional-dsp">Beyond Traditional DSP</h3>
<p>MayaFlux enables computational patterns impossible in analog-inspired
systems:</p>
<p><strong>Recursive Processing</strong></p>
<div class="sourceCode" id="cb43"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Recursive feedback that modifies its own structure</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> recursive_node <span class="op">=</span> vega<span class="op">.</span>custom<span class="op">([](</span><span class="dt">double</span> input<span class="op">,</span> NodeState<span class="op">&amp;</span> state<span class="op">)</span> <span class="op">{</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>state<span class="op">.</span>recursion_depth <span class="op">&lt;</span> <span class="dv">5</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> recursive_node<span class="op">-&gt;</span>process_sample<span class="op">()</span> <span class="op">*</span> <span class="fl">0.5</span> <span class="op">+</span> input<span class="op">;</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> input<span class="op">;</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a><span class="op">});</span></span></code></pre></div>
<p><strong>Grammar-Defined Pipelines</strong></p>
<div class="sourceCode" id="cb44"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Adaptive pipeline based on input characteristics</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> adaptive <span class="op">=</span> ComputationPipeline<span class="op">(</span>grammar<span class="op">)</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span>add_input<span class="op">(</span>unknown_data<span class="op">)</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span>auto_select_operations<span class="op">()</span>  <span class="co">// Grammar determines optimal path</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span>execute<span class="op">();</span></span></code></pre></div>
<p><strong>Ahead-of-Time Transformations</strong></p>
<div class="sourceCode" id="cb45"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Pre-calculate complex transformations</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> precomputed <span class="op">=</span> container<span class="op">-&gt;</span>transform_region<span class="op">(</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>    large_audio_region<span class="op">,</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">[](</span><span class="kw">auto</span> data<span class="op">)</span> <span class="op">{</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> apply_expensive_convolution<span class="op">(</span>data<span class="op">);</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a><span class="op">);</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a><span class="co">// Use precomputed results in real-time</span></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>realtime_node<span class="op">-&gt;</span>set_lookup_table<span class="op">(</span>precomputed<span class="op">);</span></span></code></pre></div>
<p><strong>Cross-Modal Synthesis</strong></p>
<div class="sourceCode" id="cb46"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Visual parameters generate audio</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> visual_to_audio <span class="op">=</span> vega<span class="op">.</span>custom<span class="op">([&amp;](</span><span class="dt">double</span> input<span class="op">)</span> <span class="op">{</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> pixel_brightness <span class="op">=</span> visual_buffer<span class="op">-&gt;</span>sample_at<span class="op">(</span>x<span class="op">,</span> y<span class="op">);</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> frequency <span class="op">=</span> map_range<span class="op">(</span>pixel_brightness<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">255</span><span class="op">,</span> <span class="dv">20</span><span class="op">,</span> <span class="dv">2000</span><span class="op">);</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sine_wave<span class="op">(</span>frequency<span class="op">);</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a><span class="op">});</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a><span class="co">// Audio parameters generate visuals</span></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> audio_to_visual <span class="op">=</span> <span class="op">[&amp;](</span><span class="at">const</span> SpectralData<span class="op">&amp;</span> spectrum<span class="op">)</span> <span class="op">{</span></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> freq_bin <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> freq_bin <span class="op">&lt;</span> <span class="dv">1024</span><span class="op">;</span> <span class="op">++</span>freq_bin<span class="op">)</span> <span class="op">{</span></span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> energy <span class="op">=</span> spectrum<span class="op">[</span>freq_bin<span class="op">];</span></span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>        visual_buffer<span class="op">-&gt;</span>set_pixel_color<span class="op">(</span>freq_bin<span class="op">,</span> map_to_color<span class="op">(</span>energy<span class="op">));</span></span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a><span class="op">};</span></span></code></pre></div>
<h3 id="research-questions">Research Questions</h3>
<p>MayaFlux is presented as an <strong>architectural experiment</strong>
seeking community validation:</p>
<ol type="1">
<li><strong>Does C++20 enable genuinely unified multimedia
processing?</strong>
<ul>
<li>Are coroutines sufficient for complex temporal coordination?</li>
<li>Can lock-free patterns scale to large-scale creative systems?</li>
</ul></li>
<li><strong>Is grammar-based computation viable for real-time creative
work?</strong>
<ul>
<li>Performance implications of rule matching?</li>
<li>Expressive power vs. computational overhead?</li>
</ul></li>
<li><strong>Can cross-modal abstractions remain performant?</strong>
<ul>
<li>NDData overhead in tight loops?</li>
<li>Cache coherency with dimensional abstractions?</li>
</ul></li>
<li><strong>What creative workflows emerge from digital-first
thinking?</strong>
<ul>
<li>What patterns become possible that weren’t before?</li>
<li>What analog metaphors actually serve creativity vs. constrain
it?</li>
</ul></li>
</ol>
<hr />
<h2 id="seeking-adversarial-testing-and-community-validation">Seeking:
Adversarial Testing and Community Validation</h2>
<p>This project needs:</p>
<ul>
<li><strong>Alpha testers</strong> willing to break things</li>
<li><strong>Code review</strong> from experienced C++ developers</li>
<li><strong>Creative validation</strong> from composers, visual artists,
researchers</li>
<li><strong>Use cases</strong> I haven’t imagined</li>
<li><strong>Architectural critique</strong> - what scales, what
doesn’t?</li>
</ul>
<p>MayaFlux is <strong>not presented as a finished tool</strong>, but as
a <strong>paradigm proposal</strong> seeking validation or refutation
through community scrutiny.</p>
<p>The core systems work. The tests pass. But 6 months of solo
development cannot validate real-world usage patterns, edge cases, or
creative applicability.</p>
<p><strong>This is an honest call for collaboration</strong> - to either
prove this paradigm has merit or expose its fundamental limitations
through adversarial testing and creative exploration.</p>
<hr />
<h2 id="contact-resources">Contact &amp; Resources</h2>
<p><strong>ADC25 Virtual Presentation</strong></p>
<ul>
<li>30-minute discussion slots available</li>
<li>Live demos and code walkthrough</li>
<li>GitHub repository (available upon request)</li>
<li>Comprehensive documentation</li>
</ul>
<p><strong>Project Status</strong></p>
<ul>
<li>~35,000 lines of C++ (excluding dependencies)</li>
<li>700+ component tests</li>
<li>6 months solo development</li>
<li>Early-stage architectural research</li>
</ul>
<p><strong>Seeking</strong></p>
<ul>
<li>Adversarial testing collaborators</li>
<li>Code review from audio/graphics developers</li>
<li>Creative use case validation</li>
<li>Research partnerships</li>
</ul>
<hr />
<p><em>MayaFlux represents not just a new framework, but a fundamental
rethinking of creative computation - moving from analog simulation to
true digital-first paradigms where data transformation becomes the
primary creative medium.</em></p>
</body>
</html>
